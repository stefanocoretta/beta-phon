<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Stefano Coretta">
<meta name="author" content="Paul Bürkner">
<meta name="keywords" content="acoustics, articulation, proportions, Bayesian regressions, beta distribution">

<title>Bayesian beta regressions with brms in R: A tutorial for phoneticians</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="manuscript_files/libs/clipboard/clipboard.min.js"></script>
<script src="manuscript_files/libs/quarto-html/quarto.js"></script>
<script src="manuscript_files/libs/quarto-html/popper.min.js"></script>
<script src="manuscript_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="manuscript_files/libs/quarto-html/anchor.min.js"></script>
<link href="manuscript_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="manuscript_files/libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="manuscript_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="manuscript_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="manuscript_files/libs/bootstrap/bootstrap-973236bd072d72a04ee9cd82dcc9cb29.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="manuscript.pdf"><i class="bi bi-file-pdf"></i>PDF (elsevier)</a></li></ul></div></div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Bayesian beta regressions with brms in R: A tutorial for phoneticians</h1>
</div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Authors</div>
  <div class="quarto-title-meta-heading">Affiliations</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author">Stefano Coretta <a href="mailto:s.coretta@ed.ac.uk" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> </p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            University of Edinburgh
          </p>
      </div>
    <div class="quarto-title-meta-contents">
    <p class="author">Paul Bürkner <a href="mailto:paul.buerkner@gmail.com" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> </p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            TU Dortmund University
          </p>
      </div>
  </div>

<div class="quarto-title-meta">

      
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">Monday, February 10, 2025</p>
    </div>
  </div>
  
    
  </div>
  
<div>
  <div class="abstract">
    <div class="block-title">Abstract</div>
    <p>Phonetic research frequently involves analyzing numeric continuous outcome variables, such as durations, frequencies, loudness, and ratios. Another commonly used outcome type is proportions, including measures like the proportion of voicing during closure, gesture amplitude, and nasalance. Despite their bounded nature, proportions are often modeled using Gaussian regression, largely due to the default settings of commonly used statistical functions in R (e.g., lm() and lmer() from lme4). This practice persists in teaching and research, despite the fact that Gaussian models assume unbounded continuous data and may poorly fit proportion data. To address this issue, this tutorial introduces beta regression models, a more appropriate statistical approach for analyzing proportions. The beta distribution provides a flexible framework for modelling continuous data constrained between 0 and 1. The tutorial employs the brms package in R and assumes familiarity with regression modeling but no prior knowledge of Bayesian statistics. The tutorial includes two case studies illustrating the practical implementation of Bayesian beta regression models. Data and code are available at <a href="https://github.com/stefanocoretta/beta-phon" class="uri">https://github.com/stefanocoretta/beta-phon</a>.</p>
  </div>
</div>

<div>
  <div class="keywords">
    <div class="block-title">Keywords</div>
    <p>acoustics, articulation, proportions, Bayesian regressions, beta distribution</p>
  </div>
</div>

</header>


<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>Phonetic research often involves numeric continuous outcome variables, like durations, frequencies, loudness and ratios <span class="citation" data-cites="kluender1988 johnson2003 gick2013 ladefoged2014 abramson2017 roettger2018 coretta2023 rosen2005">(<a href="#ref-abramson2017" role="doc-biblioref">Abramson and Whalen, 2017</a>; <a href="#ref-coretta2023" role="doc-biblioref">Coretta et al., 2023</a>; <a href="#ref-gick2013" role="doc-biblioref">Gick et al., 2013</a>; <a href="#ref-johnson2003" role="doc-biblioref">Johnson, 2003</a>; <a href="#ref-kluender1988" role="doc-biblioref">Kluender et al., 1988</a>; <a href="#ref-ladefoged2014" role="doc-biblioref">Ladefoged and Johnson, 2014</a>; <a href="#ref-roettger2018" role="doc-biblioref">Roettger et al., 2018</a>; <a href="#ref-rosen2005" role="doc-biblioref">Rosen, 2005</a>)</span>. Another commonly employed type of outcome variable are proportions: for example, proportion of voicing during closure <span class="citation" data-cites="davidson2016">(<a href="#ref-davidson2016" role="doc-biblioref">Davidson, 2016</a>)</span>, vocal folds contact quotient <span class="citation" data-cites="herbst2017">(<a href="#ref-herbst2017" role="doc-biblioref">Herbst et al., 2017</a>)</span>, gesture amplitude <span class="citation" data-cites="carignan2021">(<a href="#ref-carignan2021" role="doc-biblioref">Carignan, 2021</a>)</span>, nasalance <span class="citation" data-cites="carignan2021">(<a href="#ref-carignan2021" role="doc-biblioref">Carignan, 2021</a>)</span>. Moreover, virtually any measure can be MIN-MAX normalised, a procedure which transforms values so that they are in the range 0–1.</p>
<p>Regression models (and extensions like generalised additive models) have become a <em>de facto</em> standard for the statistical analysis of a variety of measures in phonetic research <span class="citation" data-cites="kirby2018 politzerahles2018 tavakoli2024">(<a href="#ref-kirby2018" role="doc-biblioref">Kirby and Sonderegger, 2018</a>; <a href="#ref-politzerahles2018" role="doc-biblioref">Politzer-Ahles and Piccinini, 2018</a>; <a href="#ref-tavakoli2024" role="doc-biblioref">Tavakoli et al., 2024</a>)</span>. However, there is a tendency for researchers to use Gaussian distribution families (i.e.&nbsp;probability distributions for the outcome variable) for any measure that is numeric, irrespective of whether the measure is unbounded, like in truly Gaussian variables, or bounded, like in proportions. A possible reason is that the base R function for fitting regression models, <code>lm()</code>, and the lme4 function used to fit regression models with varying terms, <code>lmer()</code> from lme4 <span class="citation" data-cites="bates2015">(<a href="#ref-bates2015" role="doc-biblioref">Bates et al., 2015</a>)</span>, both fit Gaussian regressions by default and the user does not have to specify the distribution family. This tacit default of using Gaussian models is also reflected in teaching practices, where significance test and models using the Gaussian distribution are the first to be taught <span class="citation" data-cites="baayen2008 winter2020">(<a href="#ref-baayen2008" role="doc-biblioref">Baayen, 2008</a>; <a href="#ref-winter2020" role="doc-biblioref">Winter, 2020</a>)</span>, due to their relative simplicity and the fact that regression models with other families are conceptual generalisations of Gaussian regression models. <a href="#fig-bg" class="quarto-xref">Figure&nbsp;1</a> shows how poorly a Gaussian regression model fits beta-distributed data: the dark blue line is the density of data simulated to be distributed according to a beta distribution; the light blue lines are predicted distributions as generated by a Gaussian model of the data. The predicted Gaussian distributions over-predict values between 0.5 and 0.75 and under-predict values between 0.75 and 1. Moreover, the density peak (median) of the Gaussian distributions is lower than the peak in the original data.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-bg" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-bg-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="manuscript_files/figure-html/fig-bg-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-bg-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Gaussian model fitted to beta-distributed data. The dark blue line is the density of the beta data, while the light blue lines are simulated densities of the same data based on a Gaussian model.
</figcaption>
</figure>
</div>
</div>
</div>
<p>While most researchers approach proportions with Gaussian regression models, proportion are not Gaussian by nature, since they are continuous variables bounded between 0 and 1. Thus, regression models with proportions as outcome variable should be fitted using a likelihood family that assumes such unit interval data. A common and flexible distribution for this purpose is the beta distribution. This tutorial introduces researchers to beta regression models in R using the package brms. Familiarity with regression modelling in R with a package like lme4 is assumed, but no prior knowledge of Bayesian statistics is necessary. The rest of the paper is structured as follows: <a href="#sec-beta" class="quarto-xref">Section&nbsp;2</a> introduces the mathematical underpinnings of the beta distribution, <a href="#sec-bayes" class="quarto-xref">Section&nbsp;3</a> provides the readers with a brief explanation and justification of Bayesian regression models, while <a href="#sec-case-1" class="quarto-xref">Section&nbsp;4</a> and <a href="#sec-case-2" class="quarto-xref">Section&nbsp;5</a> illustrate how to fit Bayesian beta regression models with two case studies. The research compendium with data and code can be found at <a href="https://github.com/stefanocoretta/beta-phon" class="uri">https://github.com/stefanocoretta/beta-phon</a>.</p>
</section>
<section id="sec-beta" class="level1">
<h1>The beta distribution</h1>
<p>The beta distribution is often considered as <em>the</em> distribution for the modelling of unit interval data <span class="citation" data-cites="ferrari_beta_2004 cribari-neto_beta_2010">(<a href="#ref-cribari-neto_beta_2010" role="doc-biblioref">Cribari-Neto and Zeileis, 2010a</a>; <a href="#ref-ferrari_beta_2004" role="doc-biblioref">Ferrari and Cribari-Neto, 2004</a>)</span>. It has been extensively studied theoretically <span class="citation" data-cites="krysicki_new_1999 gupta_handbook_2014 espinheira_beta_2008">(<a href="#ref-espinheira_beta_2008" role="doc-biblioref">Espinheira et al., 2008</a>; <a href="#ref-gupta_handbook_2014" role="doc-biblioref">Gupta and Nadarajah, 2014</a>; <a href="#ref-krysicki_new_1999" role="doc-biblioref">Krysicki, 1999</a>)</span> and is used a baseline to compare other unit interval distributions against <span class="citation" data-cites="kieschnick_regression_2003 bonat_regression_2013 lopez_bayesian_2013">(<a href="#ref-bonat_regression_2013" role="doc-biblioref">Bonat et al., 2013</a>; <a href="#ref-kieschnick_regression_2003" role="doc-biblioref">Kieschnick and McCullough, 2003</a>; <a href="#ref-lopez_bayesian_2013" role="doc-biblioref">López, 2013</a>)</span>. Specifically in Bayesian regression models, it was shown to perform well across a wide range of scenarios <span class="citation" data-cites="scholz_posterior_2023 scholz_prediction_2025">(<a href="#ref-scholz_prediction_2025" role="doc-biblioref">Scholz and Bürkner, 2025</a>, <a href="#ref-scholz_posterior_2023" role="doc-biblioref">2023</a>)</span>, which is why we focus on the beta distribution in this tutorial.</p>
<p>We use a common mean parametrisation for the beta distribution with mean parameter <span class="math inline">\(\mu\)</span>, bounded between 0 and 1, and positive precision parameter <span class="math inline">\(\phi\)</span> that is roughly proportional to the inverse of the variance <span class="math inline">\(\text{Var}(y) = \frac{\mu \, (1 - \mu)}{\phi + 1}\)</span>. That is, the larger <span class="math inline">\(\phi\)</span> the smaller the variance of the corresponding beta distribution. While the mathematical details are not needed to understand the content of this tutorial, we still write down the density below for reasons of completeness:</p>
<p><span class="math display">\[
p(y \mid \mu, \phi) = \frac{1}{B(\mu \, \phi, \; (1-\mu) \, \phi)} \; y^{\mu \, \phi -1} \; (1-y)^{(1-\mu) \, \phi -1},
\]</span></p>
<p>where <span class="math inline">\(B\)</span> is the Beta function, a complex integral for whose numerical approximation efficient algorithms exist in every programming language.</p>
</section>
<section id="sec-bayes" class="level1">
<h1>Bayesian regression models</h1>
<p>Bayesian regression models are being increasingly adopted within phonetics and language research more broadly <span class="citation" data-cites="vasishth2018 nalborczyk2019 verissimo2021">(<a href="#ref-nalborczyk2019" role="doc-biblioref">Nalborczyk et al., 2019</a>; <a href="#ref-vasishth2018" role="doc-biblioref">Vasishth et al., 2018</a>; <a href="#ref-verissimo2021" role="doc-biblioref">Verissimo, 2021</a>)</span>. Bayesian inference involves updating of prior probability distributions in light of evidence from data, to produce posterior probability distributions. In Bayesian regression models, model parameters are modelled as full probability distributions, rather than point estimates as in Null Hypothesis Significance Testing. Given the difficulty of analytical solutions of model equations, Bayesian regressions rely on sampling algorithms to reconstruct the posterior distributions. The statistical language Stan <span class="citation" data-cites="standevelopmentteam2017">(<a href="#ref-standevelopmentteam2017" role="doc-biblioref">Stan Development Team, 2017</a>)</span> employs efficient and robust Markov Chain Monte Carlo algorithms for fitting a variety of models, and the R package brms allows R users to interface with Stan from within R to fit Bayesian regression models <span class="citation" data-cites="burkner2017 burkner2018 burkner2021">(<a href="#ref-burkner2021" role="doc-biblioref">Bürkner, 2021</a>, <a href="#ref-burkner2018" role="doc-biblioref">2018</a>, <a href="#ref-burkner2017" role="doc-biblioref">2017</a>)</span>.</p>
<p>The main practical advantage of Bayesian regression models over maximum-likelihood-based frequentist regression models, like those fitted with the lme4 package <span class="citation" data-cites="bates2015">(<a href="#ref-bates2015" role="doc-biblioref">Bates et al., 2015</a>)</span>, is that Bayesian regression models don’t suffer from the convergence issues that models fitted in lme4 <span class="citation" data-cites="bates2015">(<a href="#ref-bates2015" role="doc-biblioref">Bates et al., 2015</a>)</span> and other packages <span class="citation" data-cites="cribarineto2010">(<a href="#ref-cribarineto2010" role="doc-biblioref">Cribari-Neto and Zeileis, 2010b</a>)</span> that fit frequentist models do, independent of sample size. A second, long-term advantage is that Bayesian regression models allow researchers to statistically re-use information from previous studies by specifying informative priors. While prior specification is one of the main features of Bayesian inference, in this tutorial we will use the default priors as set by brms. These are sensible priors estimated from the data that facilitate convergence but bear virtually no influence on the estimated posteriors. Specifying priors requires a great deal of precise quantitative knowledge, which in most areas of phonetics we still do not possess, so that using default uninformative priors is, for the time being, theoretically sound. For practical guidance on prior specification, see <a href="https://github.com/stan-dev/stan/wiki/Prior-Choice-Recommendations" class="uri">https://github.com/stan-dev/stan/wiki/Prior-Choice-Recommendations</a>.</p>
<p>The output of Bayesian regression models is (posterior) probability distributions for the model parameters, through which researchers can quantify (un)certainty. Bayesian Credible Intervals (CrIs) can be calculated from the posterior distributions at several probability levels (e.g.&nbsp;95, 90, 80, 60%) for a more complete view on estimated parameters. Bayesian CrIs indicate that at a certain probability levels the parameter’s estimate lies within that interval: so, for example, a 90% CrI [A, B] indicates that there is a 90% probability that the estimate is between A and B. Different probability levels correspond to different levels of confidence: the higher the probability the higher the confidence (always conditional on data and model). Readers interested in a full and accessible exposition of Bayesian statistics are referred to <span class="citation" data-cites="mcelreath2019">(<a href="#ref-mcelreath2019" role="doc-biblioref">McElreath, 2019</a>)</span>. Shorter introductions can be found in <span class="citation" data-cites="etz2018">(<a href="#ref-etz2018" role="doc-biblioref">Etz et al., 2018</a>)</span>, <span class="citation" data-cites="vasishth2018">(<a href="#ref-vasishth2018" role="doc-biblioref">Vasishth et al., 2018</a>)</span> and <span class="citation" data-cites="nalborczyk2019">(<a href="#ref-nalborczyk2019" role="doc-biblioref">Nalborczyk et al., 2019</a>)</span>.</p>
</section>
<section id="sec-case-1" class="level1">
<h1>Case study 1: coarticulatory voicing within consonant closure</h1>
<p>For the first case study, we will model the proportion of coarticulatory progressive voicing within the consonant closure of voiceless stops. The measurements come from a data set of audio and electroglottographic (EGG) recordings of 19 speakers of Northwestern Italian <span class="citation" data-cites="coretta2019k coretta2020b">(<a href="#ref-coretta2020b" role="doc-biblioref">Coretta, 2020</a>, <a href="#ref-coretta2019k" role="doc-biblioref">2019</a>)</span>. The participants read frame sentences which included target words of the form /CVCo/, where C was either /k, t, p/ in all permutations and V was either /i, e, a, o, u/ (two resulting words, /peto/ and /kako/ were excluded because they are profanities), for a total of 43 target words. There were 4 different frame sentence: <em>Scrivete X sul foglio</em> ‘Write X on the sheet’, <em>Ha detto X sei volte</em> ‘She said X six times’, <em>Sentivo X di nuovo</em> ‘I heard X again’, <em>Ripete X da sempre</em> ‘She’s been repeating X since ever’. There is a total of 172 trials per participant (3,268 grand total). The actual observation count is 2,419, after removing speech errors, EGG measurement errors, and cases in which voicing ceased before the closure onset/after the closure offset of the second consonant in the target word.</p>
<p>The proportion of voicing during the closure of the second consonant was calculated as the proportion of contiguous voicing duration after closure onset to total duration of closure. The following code chunk attaches the tidyverse packages <span class="citation" data-cites="wickham2019">(for reading and wrangling data, <a href="#ref-wickham2019" role="doc-biblioref">Wickham et al., 2019</a>)</span> and loads the <code>ita_egg</code> tibble (data frame). The tibble is filtered so as to remove voicing proportions (<code>voi_clo_prop</code>) that are smaller than 0 and greater than 1. The variables <code>vowel</code> (first vowel in the target word) and <code>c2</code> (second consonant in the target word) are converted to factors to specify the order of the levels. <a href="#tbl-ita-egg" class="quarto-xref">Table&nbsp;1</a> shows the first ten rows of the tibble (only relevant columns are included).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># attach tidyverse and set light theme for plots</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_light</span>())</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># load tibble</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"data/coretta2018/ita_egg.rda"</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co"># filter and mutate data</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>ita_egg <span class="ot">&lt;-</span> ita_egg <span class="sc">|&gt;</span> </span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(voi_clo_prop <span class="sc">&gt;</span> <span class="dv">0</span>, voi_clo_prop <span class="sc">&lt;</span> <span class="dv">1</span>) <span class="sc">|&gt;</span> </span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">vowel =</span> <span class="fu">factor</span>(vowel, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"i"</span>, <span class="st">"e"</span>, <span class="st">"a"</span>, <span class="st">"o"</span>, <span class="st">"u"</span>)),</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">c2 =</span> <span class="fu">factor</span>(c2, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"k"</span>, <span class="st">"t"</span>, <span class="st">"p"</span>))</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div id="tbl-ita-egg" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-ita-egg-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: First 10 rows of the data of voicing proportion within stop closure.
</figcaption>
<div aria-describedby="tbl-ita-egg-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">speaker</th>
<th style="text-align: left;">word</th>
<th style="text-align: left;">vowel</th>
<th style="text-align: left;">c2</th>
<th style="text-align: right;">voi_clo_prop</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">it01</td>
<td style="text-align: left;">poto</td>
<td style="text-align: left;">o</td>
<td style="text-align: left;">t</td>
<td style="text-align: right;">0.0457950</td>
</tr>
<tr class="even">
<td style="text-align: left;">it01</td>
<td style="text-align: left;">topo</td>
<td style="text-align: left;">o</td>
<td style="text-align: left;">p</td>
<td style="text-align: right;">0.3522513</td>
</tr>
<tr class="odd">
<td style="text-align: left;">it01</td>
<td style="text-align: left;">pato</td>
<td style="text-align: left;">a</td>
<td style="text-align: left;">t</td>
<td style="text-align: right;">0.1440749</td>
</tr>
<tr class="even">
<td style="text-align: left;">it01</td>
<td style="text-align: left;">teto</td>
<td style="text-align: left;">e</td>
<td style="text-align: left;">t</td>
<td style="text-align: right;">0.3610916</td>
</tr>
<tr class="odd">
<td style="text-align: left;">it01</td>
<td style="text-align: left;">toto</td>
<td style="text-align: left;">o</td>
<td style="text-align: left;">t</td>
<td style="text-align: right;">0.2743519</td>
</tr>
<tr class="even">
<td style="text-align: left;">it01</td>
<td style="text-align: left;">puco</td>
<td style="text-align: left;">u</td>
<td style="text-align: left;">k</td>
<td style="text-align: right;">0.1943984</td>
</tr>
<tr class="odd">
<td style="text-align: left;">it01</td>
<td style="text-align: left;">chipo</td>
<td style="text-align: left;">i</td>
<td style="text-align: left;">p</td>
<td style="text-align: right;">0.2227896</td>
</tr>
<tr class="even">
<td style="text-align: left;">it01</td>
<td style="text-align: left;">peco</td>
<td style="text-align: left;">e</td>
<td style="text-align: left;">k</td>
<td style="text-align: right;">0.1835596</td>
</tr>
<tr class="odd">
<td style="text-align: left;">it01</td>
<td style="text-align: left;">poco</td>
<td style="text-align: left;">o</td>
<td style="text-align: left;">k</td>
<td style="text-align: right;">0.1771007</td>
</tr>
<tr class="even">
<td style="text-align: left;">it01</td>
<td style="text-align: left;">poto</td>
<td style="text-align: left;">o</td>
<td style="text-align: left;">t</td>
<td style="text-align: right;">0.1525163</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p><a href="#fig-ita-egg" class="quarto-xref">Figure&nbsp;2</a> shows the raw voicing duration proportion values split by vowel /i, e, a, o, u/ and second consonant /k, t, p/ in the /CVCo/ target words. The plot suggests that, on average, the voicing proportion is slightly lower with /k/ than with /t, p/. Moreover, there is greater variability between vowels in /t, p/ than in /k/. We will use a beta regression model to assess whether the place of articulation of the consonant affects the proportion of coarticulatory progressive voicing, while averaging across vowels (of course, another question that could be answered with the same model is if different vowels lead to difference voicing proportions, but for sake of space we restrict this tutorial to the former question). A general expectation is that the proportion of progressive voicing should increase with fronter places of articulation (so from /k/ to /t/ to /p/) given the aerodynamic constraints which obtain with vocal fold vibration during a fully occluded oral tract <span class="citation" data-cites="vandenberg1958 rothenberg1967 ohala2011">(<a href="#ref-ohala2011" role="doc-biblioref">Ohala, 2011</a>; <a href="#ref-rothenberg1967" role="doc-biblioref">Rothenberg, 1967</a>; <a href="#ref-vandenberg1958" role="doc-biblioref">van den Berg, 1958</a>)</span>.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-ita-egg" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ita-egg-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="manuscript_files/figure-html/fig-ita-egg-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ita-egg-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Proportion of voicing during the closure of the second consonant in /CVCo/ words by vowel and the second consonant.
</figcaption>
</figure>
</div>
</div>
</div>
<p>We will use brms to fit a Bayesian beta regression <span class="citation" data-cites="burkner2017">(<a href="#ref-burkner2017" role="doc-biblioref">Bürkner, 2017</a>)</span>. The model has voicing proportion as the outcome variable and the following terms: an interaction between vowel (/i, e, a, o, u/) and second consonant C2 (/k, t, p/), centred speech rate (number of syllables per second); as varying (aka random) terms, we included by-speaker varying coefficients for the vowel/consonant interaction and for centred speech rate.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> The categorical predictors vowel and C2 are coded using indexing rather than the traditional R contrasts, as advocated in <span class="citation" data-cites="mcelreath2019">(<a href="#ref-mcelreath2019" role="doc-biblioref">McElreath, 2019</a>)</span>: in R, this corresponds to suppressing the model’s intercept with the <code>0 +</code> syntax; using indexing instead of contrasts makes it easier to specify priors and uncertainty is distributed equally across all levels of categorical predictors. For pedagogical simplicity, the model will use the default priors as explained in <a href="#sec-bayes" class="quarto-xref">Section&nbsp;3</a>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># attach brms</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(brms)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># fit the model</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Takes 3 minutes on MacBook Pro 2020, M1</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>voi_prop_bm <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># model formula</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  voi_clo_prop <span class="sc">~</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># constant terms</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    <span class="dv">0</span> <span class="sc">+</span> vowel<span class="sc">:</span>c2 <span class="sc">+</span> speech_rate_c <span class="sc">+</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># varying terms</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>    (<span class="dv">0</span> <span class="sc">+</span> vowel<span class="sc">:</span>c2 <span class="sc">+</span> speech_rate_c <span class="sc">|</span> speaker),</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># uses the beta family for the outcome</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> Beta,</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> ita_egg,</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">3749</span>,</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> <span class="st">"data/cache/voi_prop_bm"</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The <code>summary()</code> function prints the full model summary. For conciseness, we will use the <code>fixef()</code> function which prints the regression coefficients. The full summary with an explanation of each part can be found in XXX. <a href="#tbl-voi-prop-fixef" class="quarto-xref">Table&nbsp;2</a> reports the output of <code>fixef()</code> as a table (we round all values to the nearest 2 digits for clarity.). For each coefficient in the model, <code>fixef()</code> prints the name of the coefficient, the mean estimate, the estimate error and the lower and upper limits of a Bayesian Credible interval (CrI). Note that all values are in log-odds, since the link function in beta regressions is the logistic function, like in binomial/Bernoulli regressions. Here, we print an 80% CrI. There is nothing special about 95% CrI within Bayesian inference and instead experts recommend to check and report a variety of CrIs. Obtaining CrIs at different probability levels allows researchers to make more fine-grained inferential statements than the frequentist significance dichotomy affords. For simplicity of exposition, we will use 80% CrIs in this case study but we strongly recommend researchers to always obtain CrIs at different levels of probability and base their inferences on all and not one in particular. To reiterate, in Bayesian inference, an 80% CrI indicates the range of values within which the true estimate falls at 80% probability or confidence.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fixef</span>(voi_prop_bm, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div id="tbl-voi-prop-fixef" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-voi-prop-fixef-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;2: Regression coefficients of a beta regression of voicing proportion (<code>voi_prop_bm</code>).
</figcaption>
<div aria-describedby="tbl-voi-prop-fixef-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">Estimate</th>
<th style="text-align: right;">Est.Error</th>
<th style="text-align: right;">Q10</th>
<th style="text-align: right;">Q90</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">speech_rate_c</td>
<td style="text-align: right;">0.08</td>
<td style="text-align: right;">0.06</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">0.15</td>
</tr>
<tr class="even">
<td style="text-align: left;">voweli:c2k</td>
<td style="text-align: right;">-0.91</td>
<td style="text-align: right;">0.14</td>
<td style="text-align: right;">-1.08</td>
<td style="text-align: right;">-0.74</td>
</tr>
<tr class="odd">
<td style="text-align: left;">vowele:c2k</td>
<td style="text-align: right;">-1.08</td>
<td style="text-align: right;">0.11</td>
<td style="text-align: right;">-1.22</td>
<td style="text-align: right;">-0.94</td>
</tr>
<tr class="even">
<td style="text-align: left;">vowela:c2k</td>
<td style="text-align: right;">-0.99</td>
<td style="text-align: right;">0.12</td>
<td style="text-align: right;">-1.14</td>
<td style="text-align: right;">-0.84</td>
</tr>
<tr class="odd">
<td style="text-align: left;">vowelo:c2k</td>
<td style="text-align: right;">-0.79</td>
<td style="text-align: right;">0.14</td>
<td style="text-align: right;">-0.96</td>
<td style="text-align: right;">-0.62</td>
</tr>
<tr class="even">
<td style="text-align: left;">vowelu:c2k</td>
<td style="text-align: right;">-1.00</td>
<td style="text-align: right;">0.16</td>
<td style="text-align: right;">-1.20</td>
<td style="text-align: right;">-0.80</td>
</tr>
<tr class="odd">
<td style="text-align: left;">voweli:c2t</td>
<td style="text-align: right;">-0.66</td>
<td style="text-align: right;">0.11</td>
<td style="text-align: right;">-0.79</td>
<td style="text-align: right;">-0.53</td>
</tr>
<tr class="even">
<td style="text-align: left;">vowele:c2t</td>
<td style="text-align: right;">-0.84</td>
<td style="text-align: right;">0.14</td>
<td style="text-align: right;">-1.02</td>
<td style="text-align: right;">-0.66</td>
</tr>
<tr class="odd">
<td style="text-align: left;">vowela:c2t</td>
<td style="text-align: right;">-1.43</td>
<td style="text-align: right;">0.13</td>
<td style="text-align: right;">-1.60</td>
<td style="text-align: right;">-1.26</td>
</tr>
<tr class="even">
<td style="text-align: left;">vowelo:c2t</td>
<td style="text-align: right;">-1.15</td>
<td style="text-align: right;">0.13</td>
<td style="text-align: right;">-1.31</td>
<td style="text-align: right;">-0.99</td>
</tr>
<tr class="odd">
<td style="text-align: left;">vowelu:c2t</td>
<td style="text-align: right;">-0.68</td>
<td style="text-align: right;">0.12</td>
<td style="text-align: right;">-0.83</td>
<td style="text-align: right;">-0.54</td>
</tr>
<tr class="even">
<td style="text-align: left;">voweli:c2p</td>
<td style="text-align: right;">-0.68</td>
<td style="text-align: right;">0.11</td>
<td style="text-align: right;">-0.81</td>
<td style="text-align: right;">-0.54</td>
</tr>
<tr class="odd">
<td style="text-align: left;">vowele:c2p</td>
<td style="text-align: right;">-0.88</td>
<td style="text-align: right;">0.15</td>
<td style="text-align: right;">-1.07</td>
<td style="text-align: right;">-0.68</td>
</tr>
<tr class="even">
<td style="text-align: left;">vowela:c2p</td>
<td style="text-align: right;">-1.14</td>
<td style="text-align: right;">0.13</td>
<td style="text-align: right;">-1.31</td>
<td style="text-align: right;">-0.98</td>
</tr>
<tr class="odd">
<td style="text-align: left;">vowelo:c2p</td>
<td style="text-align: right;">-0.66</td>
<td style="text-align: right;">0.11</td>
<td style="text-align: right;">-0.80</td>
<td style="text-align: right;">-0.53</td>
</tr>
<tr class="even">
<td style="text-align: left;">vowelu:c2p</td>
<td style="text-align: right;">-0.44</td>
<td style="text-align: right;">0.12</td>
<td style="text-align: right;">-0.59</td>
<td style="text-align: right;">-0.28</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>From the summary, we see that speech rate (number of syllables per second) has a positive effect on voicing proportion: the 80% CrI is between 0.01 and 0.15 log-odds [<span class="math inline">\(\beta\)</span> = 0.08, SD = 0.06]. Log-odds can be converted to odd-ratios by exponentiating the value: 0.01-0.15 log odds correspond to an odd-ratio of 1.01 to 1.16, or as percentages, to an increase of voicing of 1 to 16% for every increase of one syllable per second. Since this is an 80% CrI, we can be 80% confident that the true effect of speech rate is between 1-16% increase of voicing proportion, conditional on the data and model. Note that transforming measures this way is appropriate <em>only</em> with quantile-based measures (like CrIs) but not with moments like the mean and standard deviation: to correctly get mean and SDs in the transformed scale, you must first extract the posterior draws (see below), convert them and then take moments such as mean and SD <span class="citation" data-cites="burkner2025">(for a more detailed explanation, see <a href="#ref-burkner2025" role="doc-biblioref">Bürkner, 2025, p. 101</a>)</span>. In the avoidance of doubt, we will always transform the drawn values first and then take summary measures.</p>
<p>Turning now to the coefficients for vowel and C2, given the indexing approach of coding these variables the model summary and the output of <code>fixef()</code> reports the <em>predictions</em> in log-odds for each combination of vowel and C2, rather than differences between levels. The CrIs of the vowel/C2 coefficients span all negative log-odds values: these correspond to proportions that are lower than 0.5 (which is 0 in log-odds). This matches the general trends in the raw data, which we plotted in <a href="#fig-ita-egg" class="quarto-xref">Figure&nbsp;2</a>. Next, we will plot the predicted proportions of each vowel/C2 combination at mean speech rate (i.e.&nbsp;centred speech rate = 0) and then calculate the average pair-wise difference in voicing proportion between /k, t, p/.</p>
<p>Before being able to plot the predictions, it’s important to get familiar with the so-called posterior draws. Bayesian regression models are fitted using Markov Chain Monte Carlo (MCMC) methods, as briefly explained in <a href="#sec-bayes" class="quarto-xref">Section&nbsp;3</a>. The <code>brm()</code> function runs three MCMC chains with 2000 iterations each by default. These are sufficient in most cases. The first 1000 iterations of each chain are used for “warmup”, where the MCMC algorithm is optimised to find the posterior probability. The second half of the iterations, 1000 per chain, are used for sampling from the posterior probability. Each iteration returns a drawn value for each parameter in the model. The list of values drawn during the Monte Carlo sampling are called the “posterior draws”. The posterior draws are used for inference: we can plot them, summarise them, transform them and combine them in any way to answer specific questions.</p>
<p>Posterior draws can be conveniently obtained with the <code>as_draws_df()</code> from brms. For the moment, we will extract only the draws of the constant regression coefficients (model variables starting with <code>b_</code>). To check which coefficients are available in a model, use <code>get_variables()</code> from the tidybayes package <span class="citation" data-cites="kay2019">(<a href="#ref-kay2019" role="doc-biblioref">Kay, 2019</a>)</span>. <code>as_draws_df()</code> returns a tibble where each column contains the drawn values of a coefficient. <a href="#tbl-voi-prop-draws" class="quarto-xref">Table&nbsp;3</a> shows the first ten rows and first five columns of the output of <code>as_draws_df()</code>. The probability distribution of the drawn values of each coefficient is the posterior probability distribution of that coefficient. Note that, due to the indexing coding of vowel and C2, all coefficient except <code>b_speech_rate_c</code> are <em>predicted log-odds</em> for each vowel/C2 combination (the drawn values for <code>b_speech_rate_c</code> are drawn <em>differences</em> in log-odds for each unit increase of speech rate). The drawn values are in log-odds, but we can convert them to proportions with <code>plogis()</code> (we will do this when plotting below).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># extract only coefficient variables starting with "b_"</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>voi_prop_bm_draws <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(voi_prop_bm, <span class="at">variable =</span> <span class="st">"^b_"</span>, <span class="at">regex =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Dropping 'draws_df' class as required metadata was removed.</code></pre>
</div>
<div id="tbl-voi-prop-draws" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-voi-prop-draws-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;3: First ten rows and 5 columns of the posterior draws for the model <code>voi_prop_bm</code>.
</figcaption>
<div aria-describedby="tbl-voi-prop-draws-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 23%">
<col style="width: 19%">
<col style="width: 19%">
<col style="width: 19%">
<col style="width: 19%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">b_speech_rate_c</th>
<th style="text-align: right;">b_voweli:c2k</th>
<th style="text-align: right;">b_vowele:c2k</th>
<th style="text-align: right;">b_vowela:c2k</th>
<th style="text-align: right;">b_vowelo:c2k</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.1593890</td>
<td style="text-align: right;">-0.7213516</td>
<td style="text-align: right;">-1.046577</td>
<td style="text-align: right;">-1.1197185</td>
<td style="text-align: right;">-1.0191525</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.0351033</td>
<td style="text-align: right;">-0.7492306</td>
<td style="text-align: right;">-1.385450</td>
<td style="text-align: right;">-1.0633164</td>
<td style="text-align: right;">-0.8854320</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.1259352</td>
<td style="text-align: right;">-0.8472495</td>
<td style="text-align: right;">-0.975776</td>
<td style="text-align: right;">-1.0972735</td>
<td style="text-align: right;">-0.6440836</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.0640492</td>
<td style="text-align: right;">-0.7033469</td>
<td style="text-align: right;">-1.068626</td>
<td style="text-align: right;">-1.0475190</td>
<td style="text-align: right;">-0.8328252</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.0319081</td>
<td style="text-align: right;">-0.7659281</td>
<td style="text-align: right;">-1.177656</td>
<td style="text-align: right;">-0.9357499</td>
<td style="text-align: right;">-0.6955130</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.0729965</td>
<td style="text-align: right;">-0.8494392</td>
<td style="text-align: right;">-1.226692</td>
<td style="text-align: right;">-1.0635364</td>
<td style="text-align: right;">-0.7692243</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.1009609</td>
<td style="text-align: right;">-0.9546148</td>
<td style="text-align: right;">-1.072955</td>
<td style="text-align: right;">-1.1408255</td>
<td style="text-align: right;">-0.8566750</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.0735392</td>
<td style="text-align: right;">-1.0160675</td>
<td style="text-align: right;">-1.065025</td>
<td style="text-align: right;">-1.1736263</td>
<td style="text-align: right;">-0.8334884</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.0870061</td>
<td style="text-align: right;">-1.0436475</td>
<td style="text-align: right;">-1.069337</td>
<td style="text-align: right;">-1.2632061</td>
<td style="text-align: right;">-0.7941857</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.0923815</td>
<td style="text-align: right;">-1.2042168</td>
<td style="text-align: right;">-1.041238</td>
<td style="text-align: right;">-0.9158689</td>
<td style="text-align: right;">-0.6444492</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>We can now wrangle this tibble and plot the posterior distributions for each vowel/C2 combination. <a href="#tbl-voi-long" class="quarto-xref">Table&nbsp;4</a> shows the first ten rows.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>voi_prop_bm_draws_long <span class="ot">&lt;-</span> voi_prop_bm_draws <span class="sc">|&gt;</span> </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># drop b_speech_rate_c before pivoting</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>b_speech_rate_c) <span class="sc">|&gt;</span> </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># pivot vowel:c2 columns</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="st">`</span><span class="at">b_voweli:c2k</span><span class="st">`</span><span class="sc">:</span><span class="st">`</span><span class="at">b_vowelu:c2p</span><span class="st">`</span>, <span class="at">names_to =</span> <span class="st">"coeff"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># separate "coeff" labels into type ("b"), vowel and c2</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(coeff, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"type"</span>, <span class="st">"vowel"</span>, <span class="st">"c2"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div id="tbl-voi-long" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-voi-long-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;4: First ten rows of posterior draws from <code>voi_prop_bm</code> in long format.
</figcaption>
<div aria-describedby="tbl-voi-long-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">.chain</th>
<th style="text-align: right;">.iteration</th>
<th style="text-align: right;">.draw</th>
<th style="text-align: left;">type</th>
<th style="text-align: left;">vowel</th>
<th style="text-align: left;">c2</th>
<th style="text-align: right;">value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">b</td>
<td style="text-align: left;">voweli</td>
<td style="text-align: left;">c2k</td>
<td style="text-align: right;">-0.7213516</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">b</td>
<td style="text-align: left;">vowele</td>
<td style="text-align: left;">c2k</td>
<td style="text-align: right;">-1.0465766</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">b</td>
<td style="text-align: left;">vowela</td>
<td style="text-align: left;">c2k</td>
<td style="text-align: right;">-1.1197185</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">b</td>
<td style="text-align: left;">vowelo</td>
<td style="text-align: left;">c2k</td>
<td style="text-align: right;">-1.0191525</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">b</td>
<td style="text-align: left;">vowelu</td>
<td style="text-align: left;">c2k</td>
<td style="text-align: right;">-1.0523007</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">b</td>
<td style="text-align: left;">voweli</td>
<td style="text-align: left;">c2t</td>
<td style="text-align: right;">-0.6248875</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">b</td>
<td style="text-align: left;">vowele</td>
<td style="text-align: left;">c2t</td>
<td style="text-align: right;">-0.7951552</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">b</td>
<td style="text-align: left;">vowela</td>
<td style="text-align: left;">c2t</td>
<td style="text-align: right;">-1.3999773</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">b</td>
<td style="text-align: left;">vowelo</td>
<td style="text-align: left;">c2t</td>
<td style="text-align: right;">-1.0950180</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">b</td>
<td style="text-align: left;">vowelu</td>
<td style="text-align: left;">c2t</td>
<td style="text-align: right;">-0.6682030</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>For plotting, we can use ggplot2 statistics layers from the ggdist package [<span class="citation" data-cites="kay2023">(<a href="#ref-kay2023" role="doc-biblioref">Kay, 2023</a>)</span>; kay2024]. <code>stat_halfeye()</code> plots the density of the posterior probability (in grey), its median (point) and CrIs (lines). Let’s use 60 and 80% CrIs and transform the log-odds values to proportions with <code>plogis()</code>. See <a href="#fig-voi-prop-bm-1" class="quarto-xref">Figure&nbsp;3</a>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># attach ggdist package</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggdist)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>voi_prop_bm_draws_long <span class="sc">|&gt;</span> </span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="fu">plogis</span>(value), vowel)) <span class="sc">+</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_halfeye</span>(<span class="at">.width =</span> <span class="fu">c</span>(<span class="fl">0.6</span>, <span class="fl">0.8</span>)) <span class="sc">+</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="at">rows =</span> <span class="fu">vars</span>(c2)) <span class="sc">+</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">"The points are the medians and the two lines are 60 and 80% CrIs."</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-voi-prop-bm-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-voi-prop-bm-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="manuscript_files/figure-html/fig-voi-prop-bm-1-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-voi-prop-bm-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Expected predictions of voicing proportion by vowel and consonant from <code>voi_prop_bm</code>.
</figcaption>
</figure>
</div>
</div>
</div>
<p>What if we want to plot the average predicted voicing proportion for the three consonants /k, t, p/? One approach is to take the mean across vowels within each consonant for each posterior draw, and the posterior distribution of the resulting list of values is the predicted posterior distribution of voicing proportion for each consonant, assuming an “average” vowel.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>voi_prop_bm_draws_long_c2 <span class="ot">&lt;-</span> voi_prop_bm_draws_long <span class="sc">|&gt;</span> </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># grouping by .draw and c2 ensures that averaging applies only within draw and c2</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(.draw, c2) <span class="sc">|&gt;</span> </span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># calculate the mean value within draw/c2</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">value_mean =</span> <span class="fu">mean</span>(value), <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>voi_prop_bm_draws_long_c2 <span class="sc">|&gt;</span> </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="fu">plogis</span>(value_mean), c2)) <span class="sc">+</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_halfeye</span>(<span class="at">.width =</span> <span class="fu">c</span>(<span class="fl">0.6</span>, <span class="fl">0.8</span>)) <span class="sc">+</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">"The points are the medians and the two lines are 60 and 80% CrIs."</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-voi-pbdl-c2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-voi-pbdl-c2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="manuscript_files/figure-html/fig-voi-pbdl-c2-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-voi-pbdl-c2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: Expected predictions of voicing proportion by consonant, averaged across vowels.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Based on the expected posterior distributions of the mean voicing proportion by consonant, /p/ has a somewhat higher voicing proportion than /k/ and /t/. The real question is: how much higher? We can quantify this by taking the difference of the drawn values for /p/ and those for /t, k/ (all averaged across vowels). Since we want to compare /t, k/ with /p/, we should first average the average draws of /t, k/ and then take the difference of the averaged /t, k/ draws and the draws of /p/. <a href="#tbl-voi-pbd" class="quarto-xref">Table&nbsp;5</a> shows the first ten rows of the resulting data frame. The posterior distribution of the expected difference is shown in <a href="#fig-diff-p-tk" class="quarto-xref">Figure&nbsp;5</a>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>voi_prop_bm_diff <span class="ot">&lt;-</span> voi_prop_bm_draws_long_c2 <span class="sc">|&gt;</span> </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># pivot data to create one column per consonant with the mean drawn values,</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># with one draw per raw</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> c2, <span class="at">values_from =</span> value_mean) <span class="sc">|&gt;</span> </span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># calculate the mean of /k/ and /t/, for each draw</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">c2tk =</span> <span class="fu">mean</span>(<span class="fu">c</span>(c2k, c2t)),</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># calculate the difference of /p/ and /t, k/</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">c2p_tk_diff =</span> c2p <span class="sc">-</span> c2tk</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div id="tbl-voi-pbd" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-voi-pbd-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;5: First 10 rows of expected difference of voicing proportion between /t, k/ and /p/.
</figcaption>
<div aria-describedby="tbl-voi-pbd-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">.draw</th>
<th style="text-align: right;">c2k</th>
<th style="text-align: right;">c2p</th>
<th style="text-align: right;">c2t</th>
<th style="text-align: right;">c2tk</th>
<th style="text-align: right;">c2p_tk_diff</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">-0.9918200</td>
<td style="text-align: right;">-0.7450832</td>
<td style="text-align: right;">-0.9166482</td>
<td style="text-align: right;">-0.9533426</td>
<td style="text-align: right;">0.2082595</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">-1.0240673</td>
<td style="text-align: right;">-0.7904348</td>
<td style="text-align: right;">-1.0322325</td>
<td style="text-align: right;">-0.9533426</td>
<td style="text-align: right;">0.1629079</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">-0.8954946</td>
<td style="text-align: right;">-0.6873228</td>
<td style="text-align: right;">-0.8904412</td>
<td style="text-align: right;">-0.9533426</td>
<td style="text-align: right;">0.2660199</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">-0.9442361</td>
<td style="text-align: right;">-0.8135191</td>
<td style="text-align: right;">-0.9095122</td>
<td style="text-align: right;">-0.9533426</td>
<td style="text-align: right;">0.1398235</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: right;">-0.9278262</td>
<td style="text-align: right;">-0.7908457</td>
<td style="text-align: right;">-0.9200903</td>
<td style="text-align: right;">-0.9533426</td>
<td style="text-align: right;">0.1624970</td>
</tr>
<tr class="even">
<td style="text-align: right;">6</td>
<td style="text-align: right;">-0.9825895</td>
<td style="text-align: right;">-0.7283054</td>
<td style="text-align: right;">-0.9262196</td>
<td style="text-align: right;">-0.9533426</td>
<td style="text-align: right;">0.2250372</td>
</tr>
<tr class="odd">
<td style="text-align: right;">7</td>
<td style="text-align: right;">-1.0482359</td>
<td style="text-align: right;">-0.8731592</td>
<td style="text-align: right;">-1.0841208</td>
<td style="text-align: right;">-0.9533426</td>
<td style="text-align: right;">0.0801835</td>
</tr>
<tr class="even">
<td style="text-align: right;">8</td>
<td style="text-align: right;">-1.0613713</td>
<td style="text-align: right;">-0.8751219</td>
<td style="text-align: right;">-1.0741555</td>
<td style="text-align: right;">-0.9533426</td>
<td style="text-align: right;">0.0782208</td>
</tr>
<tr class="odd">
<td style="text-align: right;">9</td>
<td style="text-align: right;">-1.0622522</td>
<td style="text-align: right;">-0.9739388</td>
<td style="text-align: right;">-1.0481834</td>
<td style="text-align: right;">-0.9533426</td>
<td style="text-align: right;">-0.0205962</td>
</tr>
<tr class="even">
<td style="text-align: right;">10</td>
<td style="text-align: right;">-0.9293998</td>
<td style="text-align: right;">-0.8287910</td>
<td style="text-align: right;">-0.9526105</td>
<td style="text-align: right;">-0.9533426</td>
<td style="text-align: right;">0.1245517</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>voi_prop_bm_diff <span class="sc">|&gt;</span> </span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(c2p_tk_diff)) <span class="sc">+</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_halfeye</span>(<span class="at">.width =</span> <span class="fu">c</span>(<span class="fl">0.6</span>, <span class="fl">0.8</span>, <span class="fl">0.9</span>)) <span class="sc">+</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-diff-p-tk" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-diff-p-tk-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="manuscript_files/figure-html/fig-diff-p-tk-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-diff-p-tk-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5: Posterior distribution of the difference between the expected voicing proportion of /t, k/ vs /p/, averaged across vowels.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Once we have the posterior difference, we can obtain CrIs of the difference using <code>quantile2()</code> from the posterior package <span class="citation" data-cites="burkner2024">(<a href="#ref-burkner2024" role="doc-biblioref">Bürkner et al., 2024</a>)</span>. Beware that the values of the difference are in log-odds! We can convert these into odd-ratios with <code>exp()</code>. The output of the code below is shown in <a href="#tbl-voi-bm-quant" class="quarto-xref">Table&nbsp;6</a>. Odd-ratios indicate the ratio of the difference between A and B, so that 1 means no difference, values greater than 1 indicate an increase in A relative to B and values lower than 1 indicate a decrease in A relative to B. Odd-ratios are useful when looking at differences that are in log-odds because while the relative magnitude of the difference in proportion between two groups is the same independent of the baseline proportion, the <em>absolute</em> magnitude of the difference depends on the baseline value. For example, an odd-ratio difference of 1.25 would correspond to a proportion increase of about 3 percentage points if the baseline proportion is 0.62 but it would correspond to a proportion increase of 5 percentage points if the baseline proportion is 0.73 and 1 percentage point if the baseline is 0.99. Of course, in real research contexts it is still useful to think about absolute magnitudes and their relevance from a conceptual and methodological perspective. In this tutorial we just focus on odd-ratios for simplicity.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(posterior)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>voi_bm_quant <span class="ot">&lt;-</span> voi_prop_bm_diff <span class="sc">|&gt;</span> </span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c2p_tk_diff_ratio =</span> <span class="fu">exp</span>(c2p_tk_diff)) <span class="sc">|&gt;</span> </span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reframe</span>(</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 90% CrI</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">q90 =</span> <span class="fu">quantile2</span>(c2p_tk_diff_ratio, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.95</span>)),</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 80% CrI</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">q80 =</span> <span class="fu">quantile2</span>(c2p_tk_diff_ratio, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>)),</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 60% CrI</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">q60 =</span> <span class="fu">quantile2</span>(c2p_tk_diff_ratio, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.8</span>)),</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># round to 2 digits</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">everything</span>(), <span class="sc">~</span><span class="fu">round</span>(.x, <span class="dv">2</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div id="tbl-voi-bm-quant" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-voi-bm-quant-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;6: Upper and lower limits of 90, 80 and 60% Credible Intervals of the difference ratio of voicing proportion in /t, k/ vs /p/.
</figcaption>
<div aria-describedby="tbl-voi-bm-quant-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">q90</th>
<th style="text-align: right;">q80</th>
<th style="text-align: right;">q60</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1.07</td>
<td style="text-align: right;">1.10</td>
<td style="text-align: right;">1.14</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.38</td>
<td style="text-align: right;">1.34</td>
<td style="text-align: right;">1.30</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>Based on the model and data, there is a 90% probability that the voicing proportion in /p/ is 1.07-1.38 times longer (or 7-38% increase) than in /t, k/. At 80% confidence, the change ratio is 1.10-1.34 (or 10-34% increase) while at 60% confidence is 1.14-1.30 (14-30% increase). In other words we can be quite confident that the voicing proportion in /p/ is longer than in /t, k/ and that the increase is less than 35%. The brms package comes with a convenient function, <code>conditional_effects()</code>, to plot posterior means and CrIs based on predictors in the model. In <a href="#fig-voi-prop-bm-cond" class="quarto-xref">Figure&nbsp;6</a>, we plot the predicted proportion of voicing by consonant and vowel.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">conditional_effects</span>(voi_prop_bm, <span class="st">"c2:vowel"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-voi-prop-bm-cond" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-voi-prop-bm-cond-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="manuscript_files/figure-html/fig-voi-prop-bm-cond-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-voi-prop-bm-cond-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6: Expected voicing proportion by consonant and vowel with 95% Credible Intervals.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Finally, the package marginaleffects <span class="citation" data-cites="arelbundock2025">(<a href="#ref-arelbundock2025" role="doc-biblioref">Arel-Bundock et al., 2025</a>)</span> has two other convenience functions that return CrIs of comparisons across predictor levels (<code>avg_comparisons()</code>) and CrIs of posterior predictions across predictor levels (<code>avg_predictions</code>). Both functions take the model and a list of variables as arguments. Optionally, you can set the confidence level with the <code>conf_level</code> argument (here, we set it to 0.8, or 80%). <code>avg_comparisons()</code> allows the user to specify the type of comparison for each variable: here we set <code>"pairwise"</code> to calculate pairwise comparisons of each level of <code>c2</code>. The output of the two functions is shows in <a href="#tbl-marginal-1" class="quarto-xref">Table&nbsp;7</a> and <a href="#tbl-marginal-2" class="quarto-xref">Table&nbsp;8</a>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(marginaleffects)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="fu">avg_comparisons</span>(voi_prop_bm, <span class="at">variables =</span> <span class="fu">list</span>(<span class="at">c2 =</span> <span class="st">"pairwise"</span>), <span class="at">conf_level =</span> <span class="fl">0.8</span>, <span class="at">type =</span> <span class="st">"link"</span>)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="fu">avg_predictions</span>(voi_prop_bm, <span class="at">variables =</span> <span class="st">"vowel"</span>, <span class="at">conf_level =</span> <span class="fl">0.8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div id="tbl-marginal-1" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-marginal-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;7: Difference in expected voicing proportion by consonant, averaged across vowels, with 80% CrIs.
</figcaption>
<div aria-describedby="tbl-marginal-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">term</th>
<th style="text-align: left;">contrast</th>
<th style="text-align: right;">estimate</th>
<th style="text-align: right;">conf.low</th>
<th style="text-align: right;">conf.high</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">c2</td>
<td style="text-align: left;">mean(t) - mean(k)</td>
<td style="text-align: right;">0.035</td>
<td style="text-align: right;">-0.004</td>
<td style="text-align: right;">0.074</td>
</tr>
<tr class="even">
<td style="text-align: left;">c2</td>
<td style="text-align: left;">mean(p) - mean(k)</td>
<td style="text-align: right;">0.218</td>
<td style="text-align: right;">0.178</td>
<td style="text-align: right;">0.256</td>
</tr>
<tr class="odd">
<td style="text-align: left;">c2</td>
<td style="text-align: left;">mean(p) - mean(t)</td>
<td style="text-align: right;">0.183</td>
<td style="text-align: right;">0.145</td>
<td style="text-align: right;">0.219</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<div class="cell">
<div id="tbl-marginal-2" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-marginal-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;8: Expected voicing proportion by vowel, averaged across vowels, with 80% CrIs.
</figcaption>
<div aria-describedby="tbl-marginal-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">vowel</th>
<th style="text-align: right;">estimate</th>
<th style="text-align: right;">conf.low</th>
<th style="text-align: right;">conf.high</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">i</td>
<td style="text-align: right;">0.331</td>
<td style="text-align: right;">0.325</td>
<td style="text-align: right;">0.338</td>
</tr>
<tr class="even">
<td style="text-align: left;">e</td>
<td style="text-align: right;">0.300</td>
<td style="text-align: right;">0.293</td>
<td style="text-align: right;">0.307</td>
</tr>
<tr class="odd">
<td style="text-align: left;">a</td>
<td style="text-align: right;">0.245</td>
<td style="text-align: right;">0.238</td>
<td style="text-align: right;">0.252</td>
</tr>
<tr class="even">
<td style="text-align: left;">o</td>
<td style="text-align: right;">0.305</td>
<td style="text-align: right;">0.298</td>
<td style="text-align: right;">0.312</td>
</tr>
<tr class="odd">
<td style="text-align: left;">u</td>
<td style="text-align: right;">0.348</td>
<td style="text-align: right;">0.341</td>
<td style="text-align: right;">0.354</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
</section>
<section id="sec-case-2" class="level1">
<h1>Case study 2: coarticulatory vowel nasalisation</h1>
<p>For the second case study we will use data from <span class="citation" data-cites="carignan2021">(<a href="#ref-carignan2021" role="doc-biblioref">Carignan, 2021</a>)</span>. The study looked at properties of nasality in German VNC sequences. Here, we will focus on the effect of C voicing (voiceless /t/ vs voiced /d/) on the proportion of nasalisation within the vowel in the VNC sequence. Previous work on coarticulatory nasalisation in English has suggested that vowels followed by an NC sequence where C is voiceless (NT) should show earlier coarticulatory nasalisation than vowels followed by an NC sequence where C is voiced (ND). This pattern has been suggested to be driven by the articulatory and acoustic incompatibility of voicelessness and nasalisation, by which the velum opening gesture of the nasal consonant is pushed away (i.e.&nbsp;earlier) when the consonant following the nasal is voiceless <span class="citation" data-cites="fowler2005 beddor2009 cho2017 carignan2015">(<a href="#ref-beddor2009" role="doc-biblioref">Beddor, 2009</a>; <a href="#ref-carignan2015" role="doc-biblioref">Carignan et al., 2015</a>; <a href="#ref-cho2017" role="doc-biblioref">Cho et al., 2017</a>; <a href="#ref-fowler2005" role="doc-biblioref">Fowler, 2005</a>)</span>. Everything else being equal, a greater proportion of vowel nasalisation (from the perspective of time) should be found in vowels followed by NT than in vowels followed by ND.</p>
<p>We will model the proportion of coarticulatory nasalisation in the German short vowels /i, e, a, o, u/ when followed by /nt/ or /nd/, using a Bayesian beta regression model. The proportion was calculated as the proportion of the nasal interval to the duration of the vowel. The nasal interval was defined thus: the interval between the time of peak velocity of velum opening to the offset of the vowel. We will use the results of the regression model to answer the following questions:</p>
<ol type="1">
<li>Is the nasalisation proportion, on average across vowels, greater in voiceless NC sequences?</li>
<li>Is there individual speaker variation?</li>
</ol>
<p><a href="#tbl-nasal" class="quarto-xref">Table&nbsp;9</a> shows the first ten rows of the data. The data contains the following columns:</p>
<ul>
<li><p><code>speaker</code> indicates the speaker ID.</p></li>
<li><p><code>label</code> is the word label as given in the original data.</p></li>
<li><p><code>vowel</code> is the target vowel in the VNC sequence.</p></li>
<li><p><code>NC</code> is the NC sequence (voiceless /nt/ or voiced /nd/).</p></li>
<li><p><code>voicing</code> indicates the voicing of C.</p></li>
<li><p><code>nas_prop</code> is the proportion of coarticulatory nasalisation of the vowel.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>nasal <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/carignan2021/nasal.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div id="tbl-nasal" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-nasal-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;9: First ten rows of the nasal proportion data.
</figcaption>
<div aria-describedby="tbl-nasal-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">speaker</th>
<th style="text-align: left;">label</th>
<th style="text-align: left;">vowel</th>
<th style="text-align: left;">NC</th>
<th style="text-align: left;">voicing</th>
<th style="text-align: right;">nas_prop</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">S03</td>
<td style="text-align: left;">b_<em>U_nt</em>@___N_B17/s</td>
<td style="text-align: left;">u</td>
<td style="text-align: left;">nt</td>
<td style="text-align: left;">voiceless</td>
<td style="text-align: right;">0.3668820</td>
</tr>
<tr class="even">
<td style="text-align: left;">S03</td>
<td style="text-align: left;">b_<em>a_nd</em>@___N_B19/s</td>
<td style="text-align: left;">a</td>
<td style="text-align: left;">nd</td>
<td style="text-align: left;">voiced</td>
<td style="text-align: right;">0.1954858</td>
</tr>
<tr class="odd">
<td style="text-align: left;">S03</td>
<td style="text-align: left;">b_<em>a_nt</em>@___N_B15/s</td>
<td style="text-align: left;">a</td>
<td style="text-align: left;">nt</td>
<td style="text-align: left;">voiceless</td>
<td style="text-align: right;">0.2786485</td>
</tr>
<tr class="even">
<td style="text-align: left;">S03</td>
<td style="text-align: left;">f_<em>I_nt</em>@___N_B05/s</td>
<td style="text-align: left;">i</td>
<td style="text-align: left;">nt</td>
<td style="text-align: left;">voiceless</td>
<td style="text-align: right;">0.7642259</td>
</tr>
<tr class="odd">
<td style="text-align: left;">S03</td>
<td style="text-align: left;">l_<em>I_nd</em>@___N_B06/s</td>
<td style="text-align: left;">i</td>
<td style="text-align: left;">nd</td>
<td style="text-align: left;">voiced</td>
<td style="text-align: right;">0.0052949</td>
</tr>
<tr class="even">
<td style="text-align: left;">S03</td>
<td style="text-align: left;">p_<em>E_nt</em>____N_B09/s</td>
<td style="text-align: left;">e</td>
<td style="text-align: left;">nt</td>
<td style="text-align: left;">voiceless</td>
<td style="text-align: right;">0.3347331</td>
</tr>
<tr class="odd">
<td style="text-align: left;">S03</td>
<td style="text-align: left;">r_<em>a_nt</em>@___N_B06/s</td>
<td style="text-align: left;">a</td>
<td style="text-align: left;">nt</td>
<td style="text-align: left;">voiceless</td>
<td style="text-align: right;">0.2431760</td>
</tr>
<tr class="even">
<td style="text-align: left;">S03</td>
<td style="text-align: left;">v_<em>I_nd</em>@___N_B07/s</td>
<td style="text-align: left;">i</td>
<td style="text-align: left;">nd</td>
<td style="text-align: left;">voiced</td>
<td style="text-align: right;">0.0247572</td>
</tr>
<tr class="odd">
<td style="text-align: left;">S03</td>
<td style="text-align: left;">v__I_nt_6___N_B15/s</td>
<td style="text-align: left;">i</td>
<td style="text-align: left;">nt</td>
<td style="text-align: left;">voiceless</td>
<td style="text-align: right;">0.1350081</td>
</tr>
<tr class="even">
<td style="text-align: left;">S03</td>
<td style="text-align: left;">z_<em>E_nd</em>@___N_B17/s</td>
<td style="text-align: left;">e</td>
<td style="text-align: left;">nd</td>
<td style="text-align: left;">voiced</td>
<td style="text-align: right;">0.5378522</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="fig-nasal" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-nasal-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="manuscript_files/figure-html/fig-nasal-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-nasal-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7: Proportion of coarticulatory nasalisation during the vowel in VNC sequences in German, depending on C voicing.
</figcaption>
</figure>
</div>
</div>
</div>
<p><a href="#fig-nasal" class="quarto-xref">Figure&nbsp;7</a> shows the proportion of coarticulatory nasalisation in vowels followed by /nd/ (voiced) vs /nt/ (voiceless) sequences, for the short vowels /i, e, a, o, u/. We can see a pattern of higher nasalisation proportion in vowels followed by /nt/, at least in the vowels /a, i, o/. For /e, u/, the distribution of nasalisation proportion seems to be similar between the voiced and voiceless contexts.</p>
<p>Now onto modelling with a beta regression. Note that a full appropriate model would include further predictors (both constant and varying), but for simplicity here we include only the following predictors: voicing (voiced /nd/ vs voiceless /nt/), vowel (/i, e, a, o, u/), including an interaction between them. As varying terms, we include a varying intercept by speaker and a by-speaker varying slope for voicing and vowel in interaction. As with the model from the first case study, voicing and vowel are coded using indexing, by suppressing the intercept with <code>0 +</code>. Here’s the code of the model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>nas_prop_bm <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  nas_prop <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> voicing<span class="sc">:</span>vowel <span class="sc">+</span> (<span class="dv">0</span> <span class="sc">+</span> voicing<span class="sc">:</span>vowel <span class="sc">|</span> speaker),</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> nasal,</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> Beta,</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">3749</span>,</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> <span class="st">"data/cache/nas_prop_bm"</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s inspect the output of <code>fixef()</code>, reported in <a href="#tbl-nas-prop-fixef" class="quarto-xref">Table&nbsp;10</a>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fixef</span>(nas_prop_bm, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div id="tbl-nas-prop-fixef" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-nas-prop-fixef-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;10: Regression coefficients of a beta regression of nasalisation proportion (<code>nas_prop_bm</code>).
</figcaption>
<div aria-describedby="tbl-nas-prop-fixef-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">Estimate</th>
<th style="text-align: right;">Est.Error</th>
<th style="text-align: right;">Q10</th>
<th style="text-align: right;">Q90</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">voicingvoiced:vowela</td>
<td style="text-align: right;">-0.61</td>
<td style="text-align: right;">0.12</td>
<td style="text-align: right;">-0.77</td>
<td style="text-align: right;">-0.46</td>
</tr>
<tr class="even">
<td style="text-align: left;">voicingvoiceless:vowela</td>
<td style="text-align: right;">-0.08</td>
<td style="text-align: right;">0.09</td>
<td style="text-align: right;">-0.19</td>
<td style="text-align: right;">0.04</td>
</tr>
<tr class="odd">
<td style="text-align: left;">voicingvoiced:vowele</td>
<td style="text-align: right;">-0.19</td>
<td style="text-align: right;">0.16</td>
<td style="text-align: right;">-0.38</td>
<td style="text-align: right;">0.01</td>
</tr>
<tr class="even">
<td style="text-align: left;">voicingvoiceless:vowele</td>
<td style="text-align: right;">-0.25</td>
<td style="text-align: right;">0.10</td>
<td style="text-align: right;">-0.38</td>
<td style="text-align: right;">-0.12</td>
</tr>
<tr class="odd">
<td style="text-align: left;">voicingvoiced:voweli</td>
<td style="text-align: right;">-0.74</td>
<td style="text-align: right;">0.19</td>
<td style="text-align: right;">-0.98</td>
<td style="text-align: right;">-0.51</td>
</tr>
<tr class="even">
<td style="text-align: left;">voicingvoiceless:voweli</td>
<td style="text-align: right;">-0.12</td>
<td style="text-align: right;">0.18</td>
<td style="text-align: right;">-0.35</td>
<td style="text-align: right;">0.10</td>
</tr>
<tr class="odd">
<td style="text-align: left;">voicingvoiced:vowelo</td>
<td style="text-align: right;">-0.34</td>
<td style="text-align: right;">0.16</td>
<td style="text-align: right;">-0.54</td>
<td style="text-align: right;">-0.14</td>
</tr>
<tr class="even">
<td style="text-align: left;">voicingvoiceless:vowelo</td>
<td style="text-align: right;">0.25</td>
<td style="text-align: right;">0.15</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: right;">0.44</td>
</tr>
<tr class="odd">
<td style="text-align: left;">voicingvoiced:vowelu</td>
<td style="text-align: right;">-0.71</td>
<td style="text-align: right;">0.18</td>
<td style="text-align: right;">-0.94</td>
<td style="text-align: right;">-0.49</td>
</tr>
<tr class="even">
<td style="text-align: left;">voicingvoiceless:vowelu</td>
<td style="text-align: right;">-0.58</td>
<td style="text-align: right;">0.16</td>
<td style="text-align: right;">-0.78</td>
<td style="text-align: right;">-0.38</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>Negative log-odds indicate a proportion that is smaller than 50%, while positive log-odds a proportion that is greater than 50%. Generally, the expected log-odd predictions in <a href="#tbl-nas-prop-fixef" class="quarto-xref">Table&nbsp;10</a> are negative, indicating an overall tendency for the nasalisation to take less than 50% of the duration of the vowel. Moreover, the predictions are higher for voiceless NC sequences than for voiced NC sequences, indicating a greater proportion of nasalisation in the former. However there is vowel-specific variation, and there doesn’t seem to be much of a difference in nasalisation proportion in /e/ and /u/. <a href="#fig-nas-prop" class="quarto-xref">Figure&nbsp;8</a> shows the expected predictions with <code>conditional_effects()</code>, which should make the interpretation of the predictions from <a href="#tbl-nas-prop-fixef" class="quarto-xref">Table&nbsp;10</a> clearer.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">conditional_effects</span>(nas_prop_bm, <span class="st">"vowel:voicing"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-nas-prop" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-nas-prop-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="manuscript_files/figure-html/fig-nas-prop-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-nas-prop-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8: Expected nasalisation proportion by vowel and voicing, with 95% CrIs.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Now that we fitted the model we can use the posterior draws to answer the two research questions (repeated from above):</p>
<ol type="1">
<li>Is the nasalisation proportion, on average across vowels, greater in voiceless NC sequences?</li>
<li>Is there individual speaker variation?</li>
</ol>
<p>To answer question 1, we can calculate the average difference in nasalisation proportion by first calculating the average nasalisation across all vowels for voiced and voiceless sequences (see <a href="#tbl-nas-draws" class="quarto-xref">Table&nbsp;11</a> for the output of this step) and then take the difference of those, similarly to what we have done in the case study in <a href="#sec-case-1" class="quarto-xref">Section&nbsp;4</a>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># extract only coefficient variables starting with "b_"</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>nas_prop_bm_draws <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(nas_prop_bm, <span class="at">variable =</span> <span class="st">"^b_"</span>, <span class="at">regex =</span> <span class="cn">TRUE</span>)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>nas_prop_bm_draws_long <span class="ot">&lt;-</span> nas_prop_bm_draws <span class="sc">|&gt;</span> </span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># pivot vowel:c2 columns</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="st">`</span><span class="at">b_voicingvoiced:vowela</span><span class="st">`</span><span class="sc">:</span><span class="st">`</span><span class="at">b_voicingvoiceless:vowelu</span><span class="st">`</span>, <span class="at">names_to =</span> <span class="st">"coeff"</span>) <span class="sc">|&gt;</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># separate "coeff" labels into type ("b"), vowel and c2</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(coeff, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"type"</span>, <span class="st">"voicing"</span>, <span class="st">"vowel"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div id="tbl-nas-draws" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-nas-draws-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;11: First ten rows of posterior draws from <code>nas_prop_bm</code> in long format.
</figcaption>
<div aria-describedby="tbl-nas-draws-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">.chain</th>
<th style="text-align: right;">.iteration</th>
<th style="text-align: right;">.draw</th>
<th style="text-align: left;">type</th>
<th style="text-align: left;">voicing</th>
<th style="text-align: left;">vowel</th>
<th style="text-align: right;">value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">b</td>
<td style="text-align: left;">voicingvoiced</td>
<td style="text-align: left;">vowela</td>
<td style="text-align: right;">-0.4632870</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">b</td>
<td style="text-align: left;">voicingvoiceless</td>
<td style="text-align: left;">vowela</td>
<td style="text-align: right;">-0.0943699</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">b</td>
<td style="text-align: left;">voicingvoiced</td>
<td style="text-align: left;">vowele</td>
<td style="text-align: right;">-0.1546258</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">b</td>
<td style="text-align: left;">voicingvoiceless</td>
<td style="text-align: left;">vowele</td>
<td style="text-align: right;">-0.2080810</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">b</td>
<td style="text-align: left;">voicingvoiced</td>
<td style="text-align: left;">voweli</td>
<td style="text-align: right;">-0.4810383</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">b</td>
<td style="text-align: left;">voicingvoiceless</td>
<td style="text-align: left;">voweli</td>
<td style="text-align: right;">-0.0529377</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">b</td>
<td style="text-align: left;">voicingvoiced</td>
<td style="text-align: left;">vowelo</td>
<td style="text-align: right;">-0.3096219</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">b</td>
<td style="text-align: left;">voicingvoiceless</td>
<td style="text-align: left;">vowelo</td>
<td style="text-align: right;">0.3212456</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">b</td>
<td style="text-align: left;">voicingvoiced</td>
<td style="text-align: left;">vowelu</td>
<td style="text-align: right;">-0.6198312</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">b</td>
<td style="text-align: left;">voicingvoiceless</td>
<td style="text-align: left;">vowelu</td>
<td style="text-align: right;">-0.3680900</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>Now let’s calculate the mean nasalisation proportion within each draw by voicing, and plot the resulting posterior distributions. Note that, as discussed in <a href="#sec-case-1" class="quarto-xref">Section&nbsp;4</a>, when working with log-odds it is important to first do all necessary calculations in log-odds (here calculate the mean log-odds across vowels) and <em>then</em> transform the calculated estimands to proportions/probabilities. The output of the following code is show in <a href="#tbl-nas-long-voi" class="quarto-xref">Table&nbsp;12</a> and the density plot of the calculated draws is in <a href="#fig-nas-prop-bm-draws-long-voicing-plot" class="quarto-xref">Figure&nbsp;9</a>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>nas_prop_bm_draws_long_voicing <span class="ot">&lt;-</span> nas_prop_bm_draws_long <span class="sc">|&gt;</span> </span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># grouping by .draw and voicing ensures that averaging applies only within draw and voicing</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(.draw, voicing) <span class="sc">|&gt;</span> </span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># calculate the mean value within draw/voicing in log-odds</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">value_mean =</span> <span class="fu">mean</span>(value),</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># we can now transform log-odds to proportion with plogis()</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">value_mean_prop =</span> <span class="fu">plogis</span>(value_mean),</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div id="tbl-nas-long-voi" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-nas-long-voi-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;12: Mean nasalisation proportion by draw and voicing, averaged across vowels (first 10 rows).
</figcaption>
<div aria-describedby="tbl-nas-long-voi-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">.draw</th>
<th style="text-align: left;">voicing</th>
<th style="text-align: right;">value_mean</th>
<th style="text-align: right;">value_mean_prop</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: left;">voicingvoiced</td>
<td style="text-align: right;">-0.4056808</td>
<td style="text-align: right;">0.3999482</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: left;">voicingvoiceless</td>
<td style="text-align: right;">-0.0804466</td>
<td style="text-align: right;">0.4798992</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: left;">voicingvoiced</td>
<td style="text-align: right;">-0.3905744</td>
<td style="text-align: right;">0.4035790</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: left;">voicingvoiceless</td>
<td style="text-align: right;">-0.1227124</td>
<td style="text-align: right;">0.4693603</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: left;">voicingvoiced</td>
<td style="text-align: right;">-0.4436082</td>
<td style="text-align: right;">0.3908816</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: left;">voicingvoiceless</td>
<td style="text-align: right;">-0.1320190</td>
<td style="text-align: right;">0.4670431</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: left;">voicingvoiced</td>
<td style="text-align: right;">-0.4385607</td>
<td style="text-align: right;">0.3920840</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: left;">voicingvoiceless</td>
<td style="text-align: right;">-0.0981768</td>
<td style="text-align: right;">0.4754755</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: left;">voicingvoiced</td>
<td style="text-align: right;">-0.3827134</td>
<td style="text-align: right;">0.4054726</td>
</tr>
<tr class="even">
<td style="text-align: right;">5</td>
<td style="text-align: left;">voicingvoiceless</td>
<td style="text-align: right;">-0.2657250</td>
<td style="text-align: right;">0.4339569</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>nas_prop_bm_draws_long_voicing <span class="sc">|&gt;</span> </span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(value_mean_prop, voicing)) <span class="sc">+</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_halfeye</span>(<span class="at">.width =</span> <span class="fu">c</span>(<span class="fl">0.6</span>, <span class="fl">0.8</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-nas-prop-bm-draws-long-voicing-plot" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-nas-prop-bm-draws-long-voicing-plot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="manuscript_files/figure-html/fig-nas-prop-bm-draws-long-voicing-plot-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-nas-prop-bm-draws-long-voicing-plot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9: Expected nasalisation proportion by voicing, averaged across vowels.
</figcaption>
</figure>
</div>
</div>
</div>
<p>The plot suggests an overall greater nasalisation proportion in voiceless NC sequences. Let’s quantify how greater as we did in <a href="#sec-case-1" class="quarto-xref">Section&nbsp;4</a>. We will use odd-ratios in this context as well, i.e.&nbsp;we will convert log-odds to odd-ratios using the <code>exp()</code> (exponential) function (and as before we first calculate the difference and then exponentiate the resulting values, after which we can take summary measures, like means and quantile-based measures such as CrIs). <a href="#tbl-nas-prop-bm-diff-quant" class="quarto-xref">Table&nbsp;13</a> show the 90, 80 and 60% CrIs of the difference ratio of nasalisation proportion in voiceless vs voiced NC sequences.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>nas_prop_bm_diff <span class="ot">&lt;-</span> nas_prop_bm_draws_long_voicing <span class="sc">|&gt;</span> </span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># pivot data to create one column per voicing with the mean drawn values,</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># with one draw per raw. we need to drop the value_mean_prop col</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>value_mean_prop) <span class="sc">|&gt;</span> </span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> voicing, <span class="at">values_from =</span> value_mean) <span class="sc">|&gt;</span> </span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># calculate the difference of voiceless and voiced in log-odds</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">voicing_diff =</span> voicingvoiceless <span class="sc">-</span> voicingvoiced,</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># now transform with exp() to get the ratio difference</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">voicing_diff_ratio =</span> <span class="fu">exp</span>(voicing_diff)</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>nas_prop_bm_diff_quant <span class="ot">&lt;-</span> nas_prop_bm_diff <span class="sc">|&gt;</span> </span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reframe</span>(</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 90% CrI</span></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">q90 =</span> <span class="fu">quantile2</span>(voicing_diff_ratio, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.95</span>)),</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 80% CrI</span></span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">q80 =</span> <span class="fu">quantile2</span>(voicing_diff_ratio, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>)),</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 60% CrI</span></span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">q60 =</span> <span class="fu">quantile2</span>(voicing_diff_ratio, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.8</span>)),</span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">everything</span>(), <span class="sc">~</span><span class="fu">round</span>(.x, <span class="dv">2</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div id="tbl-nas-prop-bm-diff-quant" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-nas-prop-bm-diff-quant-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;13: Upper and lower limits of 90, 80 and 60% Credible Intervals of the difference ratio of nasalisation proportion in vowels followed by voiced vs voiceless consonants.
</figcaption>
<div aria-describedby="tbl-nas-prop-bm-diff-quant-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">q90</th>
<th style="text-align: right;">q80</th>
<th style="text-align: right;">q60</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1.23</td>
<td style="text-align: right;">1.27</td>
<td style="text-align: right;">1.33</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.69</td>
<td style="text-align: right;">1.63</td>
<td style="text-align: right;">1.56</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>The CrIs of the ratio difference in nasalisation proportion in voiceless vs voiced NC sequences suggest an increase of nasalisation in the voiceless NC sequences, with a 90% probability that the increase is between 23% and 69% of the proportion in voiced NC sequences.</p>
<p>Moving onto question 2: is there individual speaker variation? While in the recent tradition of linguistic research to use varying (aka random) effects to <em>control</em> for differences across participants, it has been proposed to use the estimates of the varying coefficients to investigate individual differences <span class="citation" data-cites="tamminga2016">(<a href="#ref-tamminga2016" role="doc-biblioref">Tamminga et al., 2016</a>)</span>. We will use the <code>spread_draws()</code> function from tidybayes <span class="citation" data-cites="kay2019">(<a href="#ref-kay2019" role="doc-biblioref">Kay, 2019</a>)</span> to extract the draws of the varying terms (in brms these are the coefficients that start with <code>r_</code>). There is quite a few steps of processing to get from the raw draws to the estimand we need: while we have commented the following code, we encourage readers to test each line sequentially and inspect the intermediate output to fully understand the process. We assume that readers are familiar enough with models with varying terms (aka random effects, mixed-effects models). What readers should note is that to obtain the expected predictions of nasalisation proportion for each speaker, the constant terms and the varying terms should be added (since the varying terms indicate the deviation of each speaker from the overall estimate).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidybayes)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>nas_prop_r <span class="ot">&lt;-</span> nas_prop_bm <span class="sc">|&gt;</span> </span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># extract draws from model, only `r_speaker` varying terms</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread_draws</span>(r_speaker[speaker,voicingvowel]) <span class="sc">|&gt;</span> </span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># separate the column voicingvowel to two columns</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(voicingvowel, <span class="fu">c</span>(<span class="st">"voicing"</span>, <span class="st">"vowel"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># join the draws with the `b_` terms</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(<span class="at">y =</span> nas_prop_bm_draws_long) <span class="sc">|&gt;</span> </span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># get the expected log-odd value of each speaker, in each draw</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># this is the sum of the `value` from the b_ terms and the value from the</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># r_speaker term.</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">r_speaker_value =</span> value <span class="sc">+</span> r_speaker) <span class="sc">|&gt;</span> </span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># group the data for summarise</span></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(.draw, speaker, voicing) <span class="sc">|&gt;</span> </span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># get mean expected log-odds by draw, speaker and voicing (averaging across vowel)</span></span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">r_speaker_value_mean =</span> <span class="fu">mean</span>(r_speaker_value)) <span class="sc">|&gt;</span> </span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># make the data wider: two columns, one for voiced and one for voiceless</span></span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> voicing, <span class="at">values_from =</span> r_speaker_value_mean) <span class="sc">|&gt;</span> </span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># finally, calculate the difference in expected log-odds of voiceless and voiced</span></span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">voicing_diff =</span> voicingvoiceless <span class="sc">-</span> voicingvoiced)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><a href="#fig-nas-prop-r" class="quarto-xref">Figure&nbsp;10</a> plots the posterior distributions of the expected log-odd difference of coarticulatory nasalisation in voiceless vs voiced NC sequences (<em>x</em>-axis), for each speaker in the data (<em>y</em>-axis), as predicted by the model. The red solid vertical line indicates the constant (overall) expected log-odd difference based on the (constant) <code>b_</code> terms. The black dashed vertical line marks log-difference 0 (i.e., no difference in proportion of nasalisation between voiceless and voiced NC).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>nas_prop_r <span class="sc">|&gt;</span> </span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(voicing_diff, <span class="fu">reorder</span>(speaker, voicing_diff))) <span class="sc">+</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_halfeye</span>() <span class="sc">+</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">mean</span>(nas_prop_bm_diff<span class="sc">$</span>voicing_diff), <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lims</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="fl">1.5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-nas-prop-r" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-nas-prop-r-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="manuscript_files/figure-html/fig-nas-prop-r-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-nas-prop-r-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;10: Expected log-odd difference of coarticulatory nasalisation in voiceless vs voiced NC sequences for each speaker.
</figcaption>
</figure>
</div>
</div>
</div>
<p>There is a lot of uncertainty within and between speakers: while the distributions of most speakers are located in the positive range, some expected distributions (see last 5 speakers at the bottom of figure) do substantially span both negative and positive values. In other words, while most speakers are more likely to have a larger nasalisation proportion in voiceless NC sequences, a few might in fact have the opposite pattern. Even among those speakers that do have a more robust positive difference, there is a lot of uncertainty as to the magnitude of the difference.</p>
</section>
<section id="conclusion" class="level1">
<h1>Conclusion</h1>
<p>In this tutorial we have presented two case studies where the outcome variable is a beta variable, i.e.&nbsp;a numeric continuous variable bounded between 0 and 1. We have shown how to fit Bayesian beta regressions to coarticulatory progressive voicing in voiceless stops in Italian in <a href="#sec-case-1" class="quarto-xref">Section&nbsp;4</a> and coarticulatory regressive nasalisation in vowels in German in <a href="#sec-case-2" class="quarto-xref">Section&nbsp;5</a>. While this tutorial alone will not be sufficient to be able to independently run full Bayesian analyses, it will serve as a first introduction for readers to jump start their learning.</p>

</section>


<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-abramson2017" class="csl-entry" role="listitem">
Abramson, A.S., Whalen, D.H., 2017. Voice onset time (<span>VOT</span>) at 50: Teoretical and practical issues in measuring voicing distinctions. Journal of Phonetics 63, 75–86. <a href="https://doi.org/10.1016/j.wocn.2017.05.002">https://doi.org/10.1016/j.wocn.2017.05.002</a>
</div>
<div id="ref-arelbundock2025" class="csl-entry" role="listitem">
Arel-Bundock, V., Greifer, N., Heiss, A., 2025. How to interpret statistical models using marginaleffects in <span>R</span> and <span>Python</span>. Journal of Statistical Software.
</div>
<div id="ref-baayen2008" class="csl-entry" role="listitem">
Baayen, R.H., 2008. Analyzing linguistic data: <span>A</span> practical introduction to statistics using <span>R</span>. Cambridge: Cambridge University Press. <a href="https://doi.org/10.1017/CBO9780511801686">https://doi.org/10.1017/CBO9780511801686</a>
</div>
<div id="ref-bates2015" class="csl-entry" role="listitem">
Bates, D., Mächler, M., Bolker, B., Walker, S., 2015. Fitting linear mixed-effects models using lme4. Journal of Statistical Software 67, 1–48.
</div>
<div id="ref-beddor2009" class="csl-entry" role="listitem">
Beddor, P.S., 2009. A coarticulatory path to sound change. Language 785–821. <a href="https://doi.org/10.1353/lan.0.0165">https://doi.org/10.1353/lan.0.0165</a>
</div>
<div id="ref-bonat_regression_2013" class="csl-entry" role="listitem">
Bonat, W.H., Jr, P.J.R., Zeviani, W.M., 2013. Regression models with responses on the unity <span>Interval</span>: <span>Specification</span>, estimation and comparison. Biometric Brazilian Journal 30, 18.
</div>
<div id="ref-burkner2021" class="csl-entry" role="listitem">
Bürkner, P.-C., 2021. Bayesian <span>Item Response Modeling</span> in <span>R</span> with brms and <span>Stan</span>. Journal of Statistical Software 100. <a href="https://doi.org/10.18637/jss.v100.i05">https://doi.org/10.18637/jss.v100.i05</a>
</div>
<div id="ref-burkner2018" class="csl-entry" role="listitem">
Bürkner, P.-C., 2018. Advanced <span>Bayesian</span> multilevel modeling with the <span>R</span> package brms. The R Journal 10, 395–411. <a href="https://doi.org/10.32614/RJ-2018-017">https://doi.org/10.32614/RJ-2018-017</a>
</div>
<div id="ref-burkner2017" class="csl-entry" role="listitem">
Bürkner, P.-C., 2017. Brms: An <span>R</span> package for <span>Bayesian</span> multilevel models using <span>Stan</span>. Journal of Statistical Software 80, 1–28. <a href="https://doi.org/10.18637/jss.v080.i01">https://doi.org/10.18637/jss.v080.i01</a>
</div>
<div id="ref-burkner2025" class="csl-entry" role="listitem">
Bürkner, P.C., 2025. The brms book: <span>Applied Bayesian</span> regression modelling using <span>R</span> and <span>Stan</span>.
</div>
<div id="ref-burkner2024" class="csl-entry" role="listitem">
Bürkner, P.C., Gabry, J., Kay, M., Vehtari, A., 2024. Posterior: <span>Tools</span> for working with posterior distributions.
</div>
<div id="ref-carignan2021" class="csl-entry" role="listitem">
Carignan, C., 2021. A practical method of estimating the time-varying degree of vowel nasalization from acoustic features. The Journal of the Acoustical Society of America 149, 911–922. <a href="https://doi.org/10.1121/10.0002925">https://doi.org/10.1121/10.0002925</a>
</div>
<div id="ref-carignan2015" class="csl-entry" role="listitem">
Carignan, C., Shosted, R.K., Fu, M., Liang, Z.-P., Sutton, B.P., 2015. A real-time <span>MRI</span> investigation of the role of lingual and pharyngeal articulation in the production of the nasal vowel system of <span>French</span>. Journal of Phonetics 50, 34–51. <a href="https://doi.org/10.1016/j.wocn.2015.01.001">https://doi.org/10.1016/j.wocn.2015.01.001</a>
</div>
<div id="ref-cho2017" class="csl-entry" role="listitem">
Cho, T., Kim, D., Kim, S., 2017. Prosodically-conditioned fine-tuning of coarticulatory vowel nasalization in <span>English</span>. Journal of Phonetics 64, 71–89. <a href="https://doi.org/10.1016/j.wocn.2016.12.003">https://doi.org/10.1016/j.wocn.2016.12.003</a>
</div>
<div id="ref-coretta2020b" class="csl-entry" role="listitem">
Coretta, S., 2020. Vowel duration and consonant voicing: A production study (PhD thesis). The University of Manchester.
</div>
<div id="ref-coretta2019k" class="csl-entry" role="listitem">
Coretta, S., 2019. Vowel duration, voicing duration, and vowel height: Acoustic and articulatory data from <span>Italian</span> [research compendium]. <a href="https://doi.org/10.17605/OSF.IO/XDGFZ">https://doi.org/10.17605/OSF.IO/XDGFZ</a>
</div>
<div id="ref-coretta2023" class="csl-entry" role="listitem">
Coretta, S., Casillas, J.V., Roessig, S., Franke, M., Ahn, B., Al-Hoorie, A.H., Al-Tamimi, J., Alotaibi, N.E., AlShakhori, M.K., Altmiller, R.M., Arantes, P., Athanasopoulou, A., Baese-Berk, M.M., Bailey, G., Sangma, C.B.A., Beier, E.J., Benavides, G.M., Benker, N., BensonMeyer, E.P., Benway, N.R., Berry, G.M., Bing, L., Bjorndahl, C., Bolyanatz, M., Braver, A., Brown, V.A., Brown, A.M., Brugos, A., Buchanan, E.M., Butlin, T., Buxó-Lugo, A., Caillol, C., Cangemi, F., Carignan, C., Carraturo, S., Caudrelier, T., Chodroff, E., Cohn, M., Cronenberg, J., Crouzet, O., Dagar, E.L., Dawson, C., Diantoro, C.A., Dokovova, M., Drake, S., Du, F., Dubuis, M., Duême, F., Durward, M., Egurtzegi, A., Elsherif, M.M., Esser, J., Ferragne, E., Ferreira, F., Fink, L.K., Finley, S., Foster, K., Foulkes, P., Franzke, R., Frazer-McKee, G., Fromont, R., García, C., Geller, J., Grasso, C.L., Greca, P., Grice, M., Grose-Hodge, M.S., Gully, A.J., Halfacre, C., Hauser, I., Hay, J., Haywood, R., Hellmuth, S., Hilger, A.I., Holliday, N., Hoogland, D., Huang, Y., Hughes, V., Icardo Isasa, A., Ilchovska, Z.G., Jeon, H.-S., Jones, J., Junges, M.N., Kaefer, S., Kaland, C., Kelley, M.C., Kelly, N.E., Kettig, T., Khattab, G., Koolen, R., Krahmer, E., Krajewska, D., Krug, A., Kumar, A.A., Lander, A., Lentz, T.O., Li, W., Li, Y., Lialiou, M., Lima, R.M., Lo, J.J.H., Lopez Otero, J.C., Mackay, B., MacLeod, B., Mallard, M., McConnellogue, C.-A.M., Moroz, G., Murali, M., Nalborczyk, L., Nenadić, F., Nieder, J., Nikolić, D., Nogueira, F.G.S., Offerman, H.M., Passoni, E., Pélissier, M., Perry, S.J., Pfiffner, A.M., Proctor, M., Rhodes, R., Rodríguez, N., Roepke, E., Röer, J.P., Sbacco, L., Scarborough, R., Schaeffler, F., Schleef, E., Schmitz, D., Shiryaev, A., Sóskuthy, M., Spaniol, M., Stanley, J.A., Strickler, A., Tavano, A., Tomaschek, F., Tucker, B.V., Turnbull, R., Ugwuanyi, K.O., Urrestarazu-Porta, I., van de Vijver, R., Van Engen, K.J., van Miltenburg, E., Wang, B.X., Warner, N., Wehrle, S., Westerbeek, H., Wiener, S., Winters, S., Wong, S.G.-J., Wood, A., Wottawa, J., Xu, C., Zárate-Sández, G., Zellou, G., Zhang, C., Zhu, J., Roettger, T.B., 2023. Multidimensional <span>Signals</span> and <span>Analytic Flexibility</span>: <span>Estimating Degrees</span> of <span>Freedom</span> in <span>Human-Speech Analyses</span>. Advances in Methods and Practices in Psychological Science 6. <a href="https://doi.org/10.1177/25152459231162567">https://doi.org/10.1177/25152459231162567</a>
</div>
<div id="ref-cribarineto2010" class="csl-entry" role="listitem">
Cribari-Neto, F., Zeileis, A., 2010b. Beta <span>Regression</span> in <span>R</span>. Journal of Statistical Software 34. <a href="https://doi.org/10.18637/jss.v034.i02">https://doi.org/10.18637/jss.v034.i02</a>
</div>
<div id="ref-cribari-neto_beta_2010" class="csl-entry" role="listitem">
Cribari-Neto, F., Zeileis, A., 2010a. Beta <span>Regression</span> in <em>r</em>. Journal of Statistical Software 34. <a href="https://doi.org/10.18637/jss.v034.i02">https://doi.org/10.18637/jss.v034.i02</a>
</div>
<div id="ref-davidson2016" class="csl-entry" role="listitem">
Davidson, L., 2016. Variability in the implementation of voicing in <span>American English</span> obstruents. Journal of Phonetics 54, 35–50. <a href="https://doi.org/10.1016/j.wocn.2015.09.003">https://doi.org/10.1016/j.wocn.2015.09.003</a>
</div>
<div id="ref-espinheira_beta_2008" class="csl-entry" role="listitem">
Espinheira, P.L., Ferrari, S.L., Cribari-Neto, F., 2008. On beta regression residuals. Journal of Applied Statistics 35, 407–419.
</div>
<div id="ref-etz2018" class="csl-entry" role="listitem">
Etz, A., Gronau, Q.F., Dablander, F., Edelsbrunner, P.A., Baribault, B., 2018. How to become a <span>Bayesian</span> in eight easy steps: An annotated reading list. Psychonomic Bulletin &amp; Review 25, 219–234. <a href="https://doi.org/10.3758/s13423-017-1317-5">https://doi.org/10.3758/s13423-017-1317-5</a>
</div>
<div id="ref-ferrari_beta_2004" class="csl-entry" role="listitem">
Ferrari, S., Cribari-Neto, F., 2004. Beta <span>Regression</span> for <span>Modelling</span> <span>Rates</span> and <span>Proportions</span>. Journal of Applied Statistics 31, 799–815. <a href="https://doi.org/10.1080/0266476042000214501">https://doi.org/10.1080/0266476042000214501</a>
</div>
<div id="ref-fowler2005" class="csl-entry" role="listitem">
Fowler, C.A., 2005. Parsing coarticulated speech in perception: Effects of coarticulation resistance. Journal of Phonetics 33, 199–213. <a href="https://doi.org/10.1016/j.wocn.2004.10.003">https://doi.org/10.1016/j.wocn.2004.10.003</a>
</div>
<div id="ref-gelman2005" class="csl-entry" role="listitem">
Gelman, A., 2005. Analysis of variance—why it is more important than ever. The Annals of Statistics 33. <a href="https://doi.org/10.1214/009053604000001048">https://doi.org/10.1214/009053604000001048</a>
</div>
<div id="ref-gick2013" class="csl-entry" role="listitem">
Gick, B., Wilson, I., Derrick, D., 2013. Articulatory phonetics. Wiley-Blackwell.
</div>
<div id="ref-gupta_handbook_2014" class="csl-entry" role="listitem">
Gupta, A.K., Nadarajah, S., 2014. Handbook of <span>Beta</span> <span>Distribution</span> and <span>Its</span> <span>Applications</span>. CRC Press, Boca Raton. <a href="https://doi.org/10.1201/9781482276596">https://doi.org/10.1201/9781482276596</a>
</div>
<div id="ref-herbst2017" class="csl-entry" role="listitem">
Herbst, C.T., Schutte, H.K., Bowling, D.L., Svec, J.G., 2017. Comparing chalk with cheese: <span>The EGG</span> contact quotient is only a limited surrogate of the closed quotient. Journal of Voice 31, 401–409. <a href="https://doi.org/10.1016/j.jvoice.2016.11.007">https://doi.org/10.1016/j.jvoice.2016.11.007</a>
</div>
<div id="ref-johnson2003" class="csl-entry" role="listitem">
Johnson, K., 2003. Acoustic and auditory phonetics. Wiley-Blackwell. <a href="https://doi.org/10.1159/000078663">https://doi.org/10.1159/000078663</a>
</div>
<div id="ref-kay2023" class="csl-entry" role="listitem">
Kay, M., 2023. Ggdist: <span>Visualizations</span> of <span>Distributions</span> and <span>Uncertainty</span> in the <span>Grammar</span> of <span>Graphics</span>. IEEE Transactions on Visualization and Computer Graphics 1–11. <a href="https://doi.org/10.1109/TVCG.2023.3327195">https://doi.org/10.1109/TVCG.2023.3327195</a>
</div>
<div id="ref-kay2019" class="csl-entry" role="listitem">
Kay, M., 2019. Tidybayes: Tidy data and geoms for <span>Bayesian</span> models.
</div>
<div id="ref-kieschnick_regression_2003" class="csl-entry" role="listitem">
Kieschnick, R., McCullough, B.D., 2003. Regression analysis of variates observed on (0, 1): Percentages, proportions and fractions. Statistical Modelling 3, 193–213. <a href="https://doi.org/10.1191/1471082X03st053oa">https://doi.org/10.1191/1471082X03st053oa</a>
</div>
<div id="ref-kirby2018" class="csl-entry" role="listitem">
Kirby, J., Sonderegger, M., 2018. Mixed-effects design analysis for experimental phonetics. Journal of Phonetics 70, 70–85. <a href="https://doi.org/10.1016/j.wocn.2018.05.005">https://doi.org/10.1016/j.wocn.2018.05.005</a>
</div>
<div id="ref-kluender1988" class="csl-entry" role="listitem">
Kluender, K.R., Diehl, R.L., Wright, B.A., 1988. Vowel-length differences before voiced and voiceless consonants: An auditory explanation. Journal of Phonetics 16, 153–169. <a href="https://doi.org/10.1016/S0095-4470(19)30480-2">https://doi.org/10.1016/S0095-4470(19)30480-2</a>
</div>
<div id="ref-krysicki_new_1999" class="csl-entry" role="listitem">
Krysicki, W., 1999. On some new properties of the beta distribution. Statistics &amp; Probability Letters 42, 131–137. <a href="https://doi.org/10.1016/S0167-7152(98)00197-7">https://doi.org/10.1016/S0167-7152(98)00197-7</a>
</div>
<div id="ref-ladefoged2014" class="csl-entry" role="listitem">
Ladefoged, P., Johnson, K., 2014. A course in phonetics. Cengage learning.
</div>
<div id="ref-lopez_bayesian_2013" class="csl-entry" role="listitem">
López, F.O., 2013. A <span>Bayesian</span> <span>Approach</span> to <span>Parameter</span> <span>Estimation</span> in <span>Simplex</span> <span>Regression</span> <span>Model</span>: <span>A</span> <span>Comparison</span> with <span>Beta</span> <span>Regression</span>. Revista Colombiana de Estadística 21.
</div>
<div id="ref-mcelreath2019" class="csl-entry" role="listitem">
McElreath, R., 2019. Statistical rethinking: <span>A Bayesian</span> course with examples in <span>R</span> and <span>Stan</span>. Boca Raton, FL: CRC Press.
</div>
<div id="ref-nalborczyk2019" class="csl-entry" role="listitem">
Nalborczyk, L., Batailler, C., Loevenbruck, H., Vilain, A., Bürkner, P.-C., 2019. An introduction to <span>Bayesian</span> multilevel models using brms: A case study of gender effects on vowel variability in <span>Standard Indonesian</span>. Journal of Speech, Language, and Hearing Research. <a href="https://doi.org/10.1044/2018_JSLHR-S-18-0006">https://doi.org/10.1044/2018_JSLHR-S-18-0006</a>
</div>
<div id="ref-ohala2011" class="csl-entry" role="listitem">
Ohala, J.J., 2011. Accommodation to the aerodynamic voicing constraint and its phonological relevance, in: Proceedings of the 17th <span>International Congress</span> of <span>Phonetic Sciences</span>. pp. 64–67.
</div>
<div id="ref-politzerahles2018" class="csl-entry" role="listitem">
Politzer-Ahles, S., Piccinini, P., 2018. On visualizing phonetic data from repeated measures experiments with multiple random effects. Journal of Phonetics. <a href="https://doi.org/10.1016/j.wocn.2018.05.002">https://doi.org/10.1016/j.wocn.2018.05.002</a>
</div>
<div id="ref-roettger2018" class="csl-entry" role="listitem">
Roettger, T.B., Winter, B., Baayen, H., 2018. Emergent data analysis in phonetic sciences: Towards pluralism and reproducibility. Journal of Phonetics 73, 1–7. <a href="https://doi.org/10.1016/j.wocn.2018.12.001">https://doi.org/10.1016/j.wocn.2018.12.001</a>
</div>
<div id="ref-rosen2005" class="csl-entry" role="listitem">
Rosen, K.M., 2005. Analysis of speech segment duration with the lognormal distribution: A basis for unification and comparison. Journal of Phonetics 33, 411–426. <a href="https://doi.org/10.1016/j.wocn.2005.02.001">https://doi.org/10.1016/j.wocn.2005.02.001</a>
</div>
<div id="ref-rothenberg1967" class="csl-entry" role="listitem">
Rothenberg, M., 1967. The breath-stream dynamics of simple-released-plosive production. Basel: Biblioteca Phonetica.
</div>
<div id="ref-scholz_prediction_2025" class="csl-entry" role="listitem">
Scholz, M., Bürkner, P.-C., 2025. Prediction can be safely used as a proxy for explanation in causally consistent bayesian generalized linear models. Journal of Statistical Computation and Simulation 1–24.
</div>
<div id="ref-scholz_posterior_2023" class="csl-entry" role="listitem">
Scholz, M., Bürkner, P.-C., 2023. Posterior accuracy and calibration under misspecification in bayesian generalized linear models. arXiv preprint arXiv:2311.09081.
</div>
<div id="ref-standevelopmentteam2017" class="csl-entry" role="listitem">
Stan Development Team, 2017. Stan: A <span>C</span>++ library for probability and sampling, version 2.14.0.
</div>
<div id="ref-tamminga2016" class="csl-entry" role="listitem">
Tamminga, M., Ahern, C., Ecay, A., 2016. Generalized additive mixed models for intraspeaker variation. Linguistics Vanguard 2, 33–41. <a href="https://doi.org/10.1515/lingvan-2016-0030">https://doi.org/10.1515/lingvan-2016-0030</a>
</div>
<div id="ref-tavakoli2024" class="csl-entry" role="listitem">
Tavakoli, S., Matteo, B., Pigoli, D., Chodroff, E., Coleman, J., Gubian, M., Renwick, M.E.L., Sonderegger, M., 2024. Statistics in phonetics. Annual Review of Statistics and Its Application. <a href="https://doi.org/10.1146/annurev-statistics-112723-034642">https://doi.org/10.1146/annurev-statistics-112723-034642</a>
</div>
<div id="ref-vandenberg1958" class="csl-entry" role="listitem">
van den Berg, J., 1958. Myoelastic-aerodynamic theory of voice production. Journal of Speech and Hearing Research 1, 227–244. <a href="https://doi.org/10.1044/jshr.0103.227">https://doi.org/10.1044/jshr.0103.227</a>
</div>
<div id="ref-vasishth2018" class="csl-entry" role="listitem">
Vasishth, S., Beckman, M., Nicenboim, B., Li, F., Kong, E.J., 2018. Bayesian data analysis in the phonetic sciences: A tutorial introduction. Journal of Phonetics 71, 147–161. <a href="https://doi.org/10.1016/j.wocn.2018.07.008">https://doi.org/10.1016/j.wocn.2018.07.008</a>
</div>
<div id="ref-verissimo2021" class="csl-entry" role="listitem">
Verissimo, J., 2021. Analysis of rating scales: <span>A</span> pervasive problem in bilingualism research and a solution with <span>Bayesian</span> ordinal models. Bilingualism: Language and Cognition 24, 842–848. <a href="https://doi.org/10.1017/S1366728921000316">https://doi.org/10.1017/S1366728921000316</a>
</div>
<div id="ref-wickham2019" class="csl-entry" role="listitem">
Wickham, H., Averick, M., Bryan, J., Chang, W., McGowan, L., François, R., Grolemund, G., Hayes, A., Henry, L., Hester, J., Kuhn, M., Pedersen, T., Miller, E., Bache, S., Müller, K., Ooms, J., Robinson, D., Seidel, D., Spinu, V., Takahashi, K., Vaughan, D., Wilke, C., Woo, K., Yutani, H., 2019. Welcome to the <span>Tidyverse</span>. Journal of Open Source Software 4, 1686. <a href="https://doi.org/10.21105/joss.01686">https://doi.org/10.21105/joss.01686</a>
</div>
<div id="ref-winter2020" class="csl-entry" role="listitem">
Winter, B., 2020. Statistics for <span>Linguists</span>: <span>An Introduction Using R</span>. Routledge.
</div>
</div></section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>While the terms “random effects, intercept and slopes” are commonly employed in applied statistical work in linguistics and phonetics, we opt to use the conceptually more appropriate terminology proposed by <span class="citation" data-cites="gelman2005">(<a href="#ref-gelman2005" role="doc-biblioref">Gelman, 2005</a>)</span>: varying terms, intercepts, slopes, coefficients. Other common terms are multilevel and hierarchical terms.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>